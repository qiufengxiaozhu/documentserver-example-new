(()=>{"use strict";var t,e,i,s,n,o,r,h,a=function(t,e,i,s){return new(i||(i=Promise))((function(n,o){function r(t){try{a(s.next(t))}catch(t){o(t)}}function h(t){try{a(s.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(r,h)}a((s=s.apply(t,e||[])).next())}))};class c{constructor(t,e){this.DefaultRunCount=5,this.MaxDefaultRunCount=20,this.msgList=[],this.interval=50,this.isRuning=!1,this.maxCount=this.DefaultRunCount,this.runCount=0,this.currentIndex=0,this.timerId=null,this.runTime=0,this.interval=t||this.interval,this.maxCount=e||this.maxCount}isFinish(){return this.currentIndex>this.msgList.length-1}run(){if(this.maxCount===this.DefaultRunCount&&this.runTime&&this.msgList.length<5){const t=(Date.now()-this.runTime)/this.interval,e=Math.floor(t<1?this.maxCount:t*this.maxCount)||this.DefaultRunCount;this.maxCount=Math.min(e,this.MaxDefaultRunCount)}for(let t=this.currentIndex;t<this.currentIndex+this.maxCount;t+=1){const e=this.msgList[t];if(!e||this.runCount>=this.maxCount)break;e.bLimit&&(this.runCount+=1),this.currentIndex+=1,e.fun(...e.args)}this.currentIndex>this.msgList.length-1&&(this.msgList=[],this.currentIndex=0)}start(){if(!this.timerId){const t=this.runCount>=this.maxCount;t&&(this.isRuning=!1,this.runCount=0,this.maxCount=this.DefaultRunCount),this.runTime=Date.now();const e=this.isRuning||0===this.msgList.length?0:this.msgList.length>1?300:this.interval;t?this.timerId=setTimeout((()=>{this.doMsg()}),e):this.doMsg()}}stop(){this.timerId&&(clearTimeout(this.timerId),this.timerId=null)}handleMessage(t,e,i=!1){const s={fun:t,args:e,bLimit:i};this.msgList.push(s),this.start()}doMsg(){this.stop(),this.isRuning=!0,this.run()}}!function(t){let e,i,s,n,o,r,l,m,v,f,p,_,g,w,y,x,b,C;t.Docs_SDK_Version="1.9.3",t.Parent_Document_Selector="parent-document",function(t){t.TEXT="text",t.PRES="pres",t.SHEET="sheet",t.NOTE="note",t.PDF="pdf",t.OFD="ofd"}(e=t.DocumentType||(t.DocumentType={})),t.ApiOperation={IDocsUIAlert:"_idocs_ui_alert",IDocsUIPrompt:"_idocs_ui_prompt",IDocsUIShowDialog:"_idocs_ui_showDialog",IDocsUIShowSidebar:"_idocs_ui_showSidebar",IDocsUIShowLoadingBox:"_idocs_ui_showLoadingBox",IDocsUIHideLoadingBox:"_idocs_ui_hideLoadingBox",IDocsMenuAddUI:"_idocs_menu_addUi",IDocsSaveToRepository:"_idocs_saveToRepository",IDocsPrint:"_idocs_print",IDocsGetDocType:"_idocs_getDocType",IDocsSwitchDataProtectionMode:"_idocs_switchDataProtectionMode",IDocsIsDataProtectionOn:"_idocs_getDataProtectionStatus",IDocsGetAllComments:"_idocs_getAllComments",IDocsZoomSetPercentage:"_idocs_zoomSetPercentage",IDocsZoomGetPercentage:"_idocs_zoomGetPercentage",IDocsGetLoadStatus:"_idocs_GetLoadStatus",IDocsDocView:"_idocs_docview",IDocsExecuteCommand:"_idocs_execute_command",IDocsDownloadPdf:"_idocs_download_pdf",IDocsViewFollow:"_idocs_view_follow",IDocsViewFollowState:"_idocs_getViewFollowState",IdocsUpdateParams4Thirdparty:"_idocs_updateParams4thirdparty",IDocsContentFramesItem:"_idocs_contentFrames_item",IDocsContentFramesAdd:"_idocs_contentFrames_add",IDocsContentFramesCount:"_idocs_contentFrames_count",IDocsContentFrameGetSrc:"_idocs_contentFrame_getSrc",IDocsContentFrameSetSrc:"_idocs_contentFrame_setSrc",IDocsContentFrameDelete:"_idocs_contentFrame_delete",IDocsContentFrameFocus:"_idocs_contentFrame_focus"},function(t){t[t.isReady=5]="isReady",t[t.unReady=6]="unReady",t[t.NoPermissions=11]="NoPermissions",t[t.OldSDKVersion=12]="OldSDKVersion",t[t.APIInvoke=1001]="APIInvoke"}(i=t.IframeMessageType||(t.IframeMessageType={})),function(t){t.SheetActivate="Workbook.Event.SheetActivate",t.Change="Workbook.Event.Change",t.BeforeEdit="Workbook.Event.BeforeEdit",t.NamesAdded="Workbook.Event.NamesAdded",t.NamesModified="Workbook.Event.NamesModified",t.NamesDeleted="Workbook.Event.NamesDeleted"}(s||(s={}));class T{constructor(t,e){this.commandId=t,this.t=e}execute(){return a(this,void 0,void 0,(function*(){const e={action:t.ApiOperation.IDocsExecuteCommand,params:{commandId:this.commandId}};yield this.t.i(e)}))}}class I{constructor(t){this.t=t}createMenu(t){if(!t)return this.o="invalid argument",null;return new S(this.t,t)}createAddOnMenu(){return new S(this.t,"Add-ons",!0)}alert(t,e){return a(this,void 0,void 0,(function*(){yield this._alert(t,e,!0)}))}alertWithButtons(t,e){return a(this,void 0,void 0,(function*(){yield this._alert(t,e,!1)}))}_alert(e,i,s){return a(this,void 0,void 0,(function*(){let n=e,o=i;if(i||(o=e,n=null),!i)return void(this.o="invalid arguments");const r={action:t.ApiOperation.IDocsUIAlert,params:{title:e,message:i,okButtonOnly:s}},h=yield this.t.i(r);let a;return d.u.h(this,h),this.o||(a=h.detail),a}))}prompt(e,i){return a(this,void 0,void 0,(function*(){let s=e,n=i;if(i||(n=e,s=null),!i)return void(this.o="invalid arguments");const o={action:t.ApiOperation.IDocsUIPrompt,params:{title:e,message:i}},r=yield this.t.i(o);let h;return d.u.h(this,r),this.o||(h=r.detail),h}))}showDialog(e){return a(this,void 0,void 0,(function*(){if(!e)return void(this.o="invalid argument");const i={action:t.ApiOperation.IDocsUIShowDialog,params:{userInterface:e}},s=yield this.t.i(i);d.u.h(this,s)}))}showSidebar(e){return a(this,void 0,void 0,(function*(){if(!e||"string"!=typeof e)return void(this.o="invalid argument");const i={action:t.ApiOperation.IDocsUIShowSidebar,params:{name:e,show:!0}},s=yield this.t.i(i);return d.u.h(this,s),!(this.o||!0!==s.detail)}))}hideSidebar(e){return a(this,void 0,void 0,(function*(){if(!e||"string"!=typeof e)return void(this.o="invalid argument");const i={action:t.ApiOperation.IDocsUIShowSidebar,params:{name:e,show:!1}},s=yield this.t.i(i);return d.u.h(this,s),!(this.o||!0!==s.detail)}))}showLoading(){return a(this,void 0,void 0,(function*(){const e={action:t.ApiOperation.IDocsUIShowLoadingBox,params:{}},i=yield this.t.i(e);d.u.h(this,i)}))}hideLoading(){return a(this,void 0,void 0,(function*(){const e={action:t.ApiOperation.IDocsUIShowSidebar,params:{}},i=yield this.t.i(e);d.u.h(this,i)}))}}class S{constructor(t,e,i=!1){if(!e)throw"invalid argument";this.t=t,this.label=e,this.elements=[],this.bAddOn=!!i,this.o=null}addItem(t,e){return t&&e&&"function"==typeof e?(this.elements.push({type:"menuitem",label:t,func:e}),this):(this.o="invalid arguments",null)}addSeparator(){return this.elements.push({type:"separator"}),this}addSubMenu(t){return t?t.bAddOn?(this.o="can not add one sub-addons",null):(this.elements.push({type:"menu",sub:t}),this):(this.o="invalid argument",null)}addUi(){return a(this,void 0,void 0,(function*(){if(this.bAddOn&&this.elements.length>0){const e={action:t.ApiOperation.IDocsMenuAddUI,params:{menubarData:this.elements}};yield this.t.i(e),this.o=null}else this.o="fail to add menu to ui"}))}}class k{constructor(e,i){this.t=e,this.l=i,Object.defineProperty(this,"percentage",{get:()=>a(this,void 0,void 0,(function*(){const e={action:t.ApiOperation.IDocsZoomGetPercentage,params:{}},i=yield this.t.i(e);let s;return d.u.h(this,i),this.o||(s=i.detail),s})),set:e=>{if(!(e%1==0&&e>=10&&e<=400))return console.error("Please input valid integer: 10 ~ 400"),!1;const i={action:t.ApiOperation.IDocsZoomSetPercentage,params:{zoom:e}};this.t.i(i).then((t=>{d.u.h(this,t)}))}})}setPercentage(e){return a(this,void 0,void 0,(function*(){if(!(e%1==0&&e>=10&&e<=400))return console.error("Please input valid integer: 10 ~ 400"),!1;const i={action:t.ApiOperation.IDocsZoomSetPercentage,params:{zoom:e}},s=yield this.t.i(i);return d.u.h(this,s),!this.o&&!0===s.detail}))}}t.Zoom=k;t.ActiveWindow=class{constructor(t){this.t=t,Object.defineProperties(this,{Zoom:{get(){return this._zoom||(this._zoom=new k(this.t,this)),this._zoom}}})}};t.IDocsApp=class{constructor(t,e){this.m="",this._supported_events=new Set(["IDocs.Event.FullScreenChange","IDocs.Event.SessionExpire","IDocs.Event.FileStatus","IDocs.Event.CommentAction","IDocs.Event.ContentFrameAction"]),this.m=t,this._docType=e,this.o=null}get supportedEvents(){return this._supported_events}get docType(){return this._docType}get events(){return d.u.v(this.m)}get UI(){return this.p||(this.p=new I(this)),this.p}i(t,e){return d.u.i(this.m,t,1,"",e)}addListener(t,e){if(this.supportedEvents.has(t))return d.u._(this.m,t,e)}removeListener(t,e){this.supportedEvents.has(t)&&d.u.g(this.m,t,e)}updateParams4thirdparty(e){return a(this,void 0,void 0,(function*(){const i=yield d.u.i(this.m,{action:t.ApiOperation.IdocsUpdateParams4Thirdparty,params:{params:e}});return d.u.h(this,i),i.detail}))}addFonts(e){return a(this,void 0,void 0,(function*(){if(!e)return;const i={action:t.ApiOperation._idocs_addFonts,params:{fonts:e}};yield this.i(i)}))}ready(){return d.u.C(this.m)}commandBars(t){return new T(t,this)}};t.IDocsDocument=class{constructor(t){this.t=t}switchDataProtectionMode(){return a(this,void 0,void 0,(function*(){const e={action:t.ApiOperation.IDocsSwitchDataProtectionMode,params:{}},i=yield this.t.i(e);d.u.h(this,i);let s=!1;return this.o||(s=i.detail),s}))}isDataProtectionOn(){return a(this,void 0,void 0,(function*(){const e={action:t.ApiOperation.IDocsIsDataProtectionOn,params:{}},i=yield this.t.i(e);d.u.h(this,i);let s=!1;return this.o||(s=i.detail),s}))}save(){return a(this,void 0,void 0,(function*(){const e=yield this.t.addListener("IDocs.Event.FileStatus",(()=>{this.T&&(this.T(),this.T=null)})),i={action:t.ApiOperation.IDocsSaveToRepository,params:{}};return this.t.i(i),yield new Promise((t=>{this.T=()=>{this.t.removeListener("IDocs.Event.FileStatus",e),t(!0)}}))}))}saveAs(e,i,s){return a(this,void 0,void 0,(function*(){const n={action:t.ApiOperation.IDocsSaveToRepository,params:{saveAsOptions:{format:e,name:i,path:s}}};yield this.t.i(n)}))}print(e){return a(this,void 0,void 0,(function*(){const i={action:t.ApiOperation.IDocsPrint,params:Object.assign({},e)},s=yield this.t.i(i);d.u.h(this,s);return!this.o&&!!s.detail}))}downloadPdf(){return a(this,void 0,void 0,(function*(){const i={action:t.ApiOperation.IDocsDownloadPdf,params:{target:e.PDF}},s=yield this.t.i(i);d.u.h(this,s);return!this.o&&!!s.detail}))}startViewFollow(e){return a(this,void 0,void 0,(function*(){const i={action:t.ApiOperation.IDocsViewFollow,params:{action:e}},s=yield this.t.i(i);let n;return d.u.h(this,s),this.o||(n="success"===s.status),n}))}getViewFollowState(){return a(this,void 0,void 0,(function*(){const e={action:t.ApiOperation.IDocsViewFollowState,params:{}};return(yield this.t.i(e)).detail}))}getComments(){return a(this,void 0,void 0,(function*(){const e={action:t.ApiOperation.IDocsGetAllComments,params:{}},i=yield this.t.i(e);if(d.u.h(this,i),!this.o){const t=i.detail,e=[];for(let i=0;i<t.length;i+=1){const s=t[i],n=[];for(let t=0;t<s.length;t+=1){const e=s[t];n.push({id:e.id,content:e.content,time:e.time,users:{name:e.name,uid:e.uid}})}e.push(Object.assign(Object.assign({},n[0]),{resolved:s[0].resolved,replies:n.reduce(((t,e,i)=>(0===i||(e.pid=s[0].id,t.push(e)),t)),[])}))}return e}}))}};class R{constructor(e,i){this.t=e,this.id=i,Object.defineProperties(this,{src:{get(){return a(this,void 0,void 0,(function*(){const e={action:t.ApiOperation.IDocsContentFrameGetSrc,params:[this.id]},i=yield this.t.i(e);return d.u.h(this,i),this.o?"":i.detail}))},set(e){const i={action:t.ApiOperation.IDocsContentFrameSetSrc,params:[this.id,e]};this.t.i(i).then((t=>{d.u.h(this,t)}))}}})}delete(){return a(this,void 0,void 0,(function*(){const e={action:t.ApiOperation.IDocsContentFrameDelete,params:[this.id]},i=yield this.t.i(e);return d.u.h(this,i),!this.o&&!0===i.detail}))}focus(){return a(this,void 0,void 0,(function*(){const e={action:t.ApiOperation.IDocsContentFrameFocus,params:[this.id]},i=yield this.t.i(e);return d.u.h(this,i),!this.o&&!0===i.detail}))}}t.ContentFrame=R;t.ContentFrames=class{constructor(e){if(!e)throw"invalid argument";this.t=e,Object.defineProperties(this,{count:{get(){return a(this,void 0,void 0,(function*(){const e={action:t.ApiOperation.IDocsContentFramesCount,params:{}},i=yield this.t.i(e);return d.u.h(this,i),this.o?0:i.detail}))}}})}add(t){return a(this,void 0,void 0,(function*(){return null}))}item(e){return a(this,void 0,void 0,(function*(){const i={action:t.ApiOperation.IDocsContentFramesItem,params:[e]},s=yield this.t.i(i);return d.u.h(this,s),!this.o&&s.detail?new R(this.t,s.detail):void 0}))}},function(t){t[t.None=0]="None",t[t.appReady=1]="appReady",t[t.viewActived=2]="viewActived",t[t.isLoaded=3]="isLoaded"}(n||(n={})),function(t){t.ContextMenu="contextmenu",t.Toolbar="toolbar",t.Menubar="menubar",t.Statusbar="statusbar",t.FileMenu="fileMenu",t.ObjectFloatingMenu="objectFloatingMenu",t.TitleBar="titlebar"}(o||(o={})),function(t){t.Sidebar="sidebar"}(r||(r={})),function(t){t.WordMainContext="word-main-context",t.WordSlashContext="word-slash-context",t.ExcelCellContext="excel-cell-context",t.CommonGraphicContext="common-graphic-context"}(l||(l={})),function(t){t.PopupMenuBar="PopupMenuBar",t.MenuItem="MenuItem",t.MenuItemPopMenu="MenuItemPopMenu",t.Divider="Divider",t.Devider="Devider"}(m||(m={})),function(t){t.WordMenubarEdit="word-menubar-edit",t.WordMenubarInsert="word-menubar-insert",t.WordMenubarFormat="word-menubar-format",t.WordMenubarView="word-menubar-view",t.WordMenubarTeam="word-menubar-team",t.WordMenubarEfficiency="word-menubar-efficiency",t.ExcelMenuBarEdit="excel-menubar-edit",t.ExcelMenuBarInsert="excel-menubar-insert",t.ExcelMenuBarData="excel-menubar-data",t.ExcelMenuBarView="excel-menubar-view",t.ExcelMenuBarTeam="excel-menubar-team"}(v=t.MenubarType||(t.MenubarType={})),function(t){t.Button="Button",t.ToggleButton="ToggleButton",t.DropDownButton="DropDownButton",t.ExtensionButton="ExtensionButton",t.ExtensionChangeButton="ExtensionChangeButton",t.DefaultExtensionButton="DefaultExtensionButton",t.Devider="Devider",t.DropDownDevider="DropDownDevider",t.PopMenuButton="PopMenuButton",t.CustomButton="CustomButton"}(f||(f={})),function(t){t.WordToolbar="word-toolbar",t.ExcelToolbar="excel-toolbar"}(p||(p={})),function(t){t.WordStatusbar="word-statusbar",t.WordViewStatusbar="word-view-statusbar"}(_||(_={})),function(t){t.TEXT="TEXT",t.BUTTON="BUTTON",t.SUBMENU="SUBMENU",t.RENDER="RENDER",t.DEVIDER="DEVIDER"}(g||(g={})),function(t){t.WordFileMenu="word-fileMenu",t.ExcelFileMenu="excel-fileMenu"}(w||(w={})),function(t){t.WordContentFrameMenu="word-contentFrame-menu",t.ExcelContentFrameMenu="excel-contentFrame-menu"}(y||(y={})),function(t){t.LEFT="left",t.RIGHT="right",t.TOPLEFT="topLeft",t.TOPRIGHT="topRight"}(x||(x={})),function(t){t.Left="left",t.Right="right"}(b||(b={})),function(t){t.Top="top",t.Bottom="bottom"}(C||(C={}));t.ApiObjHelper=class{constructor(){this.I=0,this.S=5e3,this.k=1e4,this.R={},this.asyncActions=[h.ApiOperation.TextPicturesAdd],this.N=0,this.P=new Map,this.O=new Map,this.messageManager=new c}get F(){return this.I+=1,this.I}get A(){return this.N+=1,this.N}D(t,e,i,s,n){this.R[t]={win:e,origin:i,url:s,bExtensionPane:n,actionPort:null,eventPort:null,events:new Map,promiseFuncs:new Map,isConnected:!1}}initPortListener(t){t.onmessage=t=>{const e=t.data;if(e.selector){const t=this.R[e.selector].promiseFuncs,i=t.get(e.messageCode);i?"success"===e.status?i.resolve(e):i.reject(e.detail):(e.selector,e.messageCode,e.action?e.action:e.eventType),t.delete(e.messageCode),this.messageManager.isFinish()||this.messageManager.start()}else e.eventType&&this.j(e)}}M(t,e,s){const n={selector:t,messageCode:this.A,type:i.APIInvoke,docType:this.R[t].type};e?n.actionData=e:n.eventData=s;return this.H(t).bExtensionPane&&(n.extensionPaneSrc=window.location.href),n}h(t,e){t&&(e&&"error"===e.status?t.o=e.detail:t.o=null)}v(t){return Array.from(this.R[t].events.keys())}H(t){return this.R[t]}B(t){return this.H(t).isUnReady}G(t,e){for(const i in this.R){const s=this.R[i];s.url===t&&(s.isUnReady=e,e&&this.rejectHandshake(i,"The document could not be loaded!"))}}L(t,e){for(const i in this.R){this.R[i].url===t&&this.rejectHandshake(i,e)}}rejectHandshake(t,e){this.R[t].promiseFuncs.forEach((t=>{t.reject(e)})),this.R[t].promiseFuncs.clear()}W(t,e){this.R[t]&&(this.R[t].type=e)}V(e){return a(this,void 0,void 0,(function*(){const i={action:t.ApiOperation.IDocsGetLoadStatus,params:{}};return(yield this.i(e,i,10,"Wait for the document to finish loading ......")).detail}))}C(t){return a(this,void 0,void 0,(function*(){return new Promise(((e,i)=>{let s=n.None;const o=setInterval((()=>a(this,void 0,void 0,(function*(){if(this.B(t))return clearInterval(o),i(!1);s=yield this.V(t),s>=n.isLoaded&&(clearInterval(o),e(!0))}))),100)}))}))}U(e){return a(this,void 0,void 0,(function*(){const i={action:t.ApiOperation.IDocsGetDocType,params:{}};return(yield this.i(e,i)).detail}))}$(t,e){switch(t){case o.ContextMenu:return Object.values(l).includes(e);case o.FileMenu:return Object.values(w).includes(e);case o.Toolbar:return Object.values(p).includes(e);case o.Statusbar:return Object.values(_).includes(e);case o.ObjectFloatingMenu:return Object.values(y).includes(e);case o.Menubar:return Object.values(v).includes(e);default:return!1}}J(t){if(!t)return;if(!u.isJSON(t))return void console.error(`error config data: ${t}`);const e={uiConfig:t.uiConfig,extraInfo:t.extraInfo};if(!t.extensionConfig)return e;if(Array.isArray(t.extensionConfig))return console.error("error extensionConfig"),e;const{extensionCommands:i,extensionPoints:s,extensionPanes:n}=t.extensionConfig;if(!i||!Array.isArray(i)||(!s||Array.isArray(s))&&(!n||Array.isArray(n)))return console.error("error extensionConfig"),e;const h=e.extensionConfig={extensionCommands:[],extensionPoints:{},extensionPanes:{}};if(i.forEach((t=>{t.execFunc&&"function"==typeof t.execFunc&&(h.extensionCommands.push({id:t.id}),this.P.set(t.id,t.execFunc))})),s)for(let t in s)switch(t){case o.Menubar:case o.ContextMenu:case o.Toolbar:case o.Statusbar:case o.FileMenu:case o.ObjectFloatingMenu:{const e=h.extensionPoints[t]=[];s[t].forEach((i=>{if(!this.$(t,i.id)||!Array.isArray(i.items))return;const s={id:i.id,items:[]};"menubar"===t||"contextmenu"===t||"fileMenu"===t?s.position=i.position===C.Top?C.Top:C.Bottom:"objectFloatingMenu"===t?(s.position=i.position,Object.values(x).includes(i.position)||(s.position=x.LEFT)):s.position=i.position===b.Left?b.Left:b.Right,i.items.forEach((t=>{const e={action:t.action,name:t.name,description:t.description,icon:t.icon,type:t.type===m.Divider?m.Devider:t.type,payload:t.payload};t.items&&Array.isArray(t.items)&&(e.items=t.items.map((t=>({action:t.action,name:t.name,icon:t.icon,type:t.type===m.Divider?m.Devider:t.type,payload:t.payload})))),s.items.push(e)})),e.push(s)}));break}case o.TitleBar:{const e=h.extensionPoints[t]=[];s[t].forEach((t=>{const i={action:t.action,name:t.name,description:t.description,icon:t.icon,type:t.type===m.Divider?m.Devider:t.type,payload:t.payload};e.push(i)}))}}if(n)for(let t in n)if(t===r.Sidebar){const e=h.extensionPanes[t]=[];n[t].forEach((t=>{e.push({name:t.name,src:t.src})}))}return e}q(e,i,s,n,o){return a(this,void 0,void 0,(function*(){let r,h,a=o;const c=e===t.Parent_Document_Selector,d={action:"handshake",params:{version:t.Docs_SDK_Version}};if(c)this.D(e,i,void 0,void 0,!0);else{r=new URL(s).origin,u.isJSON(n)&&(a=n,h=!1),d.params.bAsync=h,d.params.config=this.J(o),this.D(e,i,r,s)}try{const t=yield this.i(e,d,10);return t.detail.match||this.K(t.detail),this.R[e].isConnected=!0,!0}catch(t){return this.rejectHandshake(e),!1}}))}Y(t,e){this.O.set(t,e)}X(t){this.O.delete(t)}Z(t,e){if(this.O.size)for(const i in this.R){this.R[i].url===t&&this.O.has(i)&&this.O.get(i)(e)}}_(t,e,i){return a(this,void 0,void 0,(function*(){const s={eventType:e};if("success"===(yield this.i(t,s)).status){this.R[t].events.has(e)||this.R[t].events.set(e,new Map);const s=this.R[t].events.get(e),n=`event${u.tt().toString()}`;return s.set(n,i),n}return""}))}g(t,e,i){return a(this,void 0,void 0,(function*(){const s=this.R[t].events.get(e);if(!s)return!1;let n=1;i?s.delete(i):(n=s.size,this.R[t].events.delete(e));const o={eventType:e,cancel:!0,count:n};return"success"===(yield this.i(t,o)).status}))}K(e){const i=e.supportedVersion;if(e.higherThan){t.Docs_SDK_Version}else e.lowerThanMinimal&&console.error("Please upgrade your SDK to version ",i)}j(t){var e;return a(this,void 0,void 0,(function*(){if(t.eventType)if("extensionCommand"!==t.eventType)try{for(const e in this.R){const i=this.R[e].events;if(!i.has(t.eventType))continue;const n=i.get(t.eventType);n&&n.forEach((i=>a(this,void 0,void 0,(function*(){const n=d.applications.get(e);switch(t.eventType){case s.Change:{const e=t.detail;if(n){const t=(yield n.ActiveWorkbook.getSheetByName(e.sheetName)).getRange(e.sr,e.sc,e.er,e.ec);i(t)}break}case s.SheetActivate:{const e=t.detail;if(n){const t=yield n.ActiveWorkbook.getSheetByName(e.sheetName);i(t)}break}case s.BeforeEdit:{const e=t.detail;if(n){const t=yield n.ActiveWorkbook.getSheetByName(e.sheetName),s=t.getRange(e.r,e.c,e.r,e.c);i(t,s)}break}default:i(t.detail)}}))))}}catch(t){}else null===(e=this.P.get(t.detail.cid))||void 0===e||e(t.detail.payload)}))}runPromise(t=!1,e,i,s){const{isAction:n,payload:o,resolve:r,reject:h,timeoutMessage:a}=s;this.et(e,n,o,t).then((t=>{r(t)}),(t=>{if(t.timeout)if(this.B(e))h(t);else if(this.retryTimes)this.retryTimes-=1,this.runPromise(!0,e,i,s);else{const e=n?i.action:i.eventType?`listening ${i.eventType}`:"handshake";a||console.error(`${e} timeout!`),h(t)}else t.constructor===Object&&t.hasOwnProperty("detail")?console.error(t.detail):console.error(t),h(t)}))}i(t,i,s=1,n,o=!1){this.retryTimes=s;const r=!!i.action,h=r?this.M(t,i):this.M(t,void 0,i);return new Promise(((s,a)=>{if(this.B(t))a("The document could not be loaded!");else{const c=h.docType===e.TEXT&&o;this.messageManager.handleMessage(this.runPromise.bind(this),[!1,t,i,{isAction:r,payload:h,timeoutMessage:n,resolve:s,reject:a}],c)}}))}et(e,i,s,n=!1){n&&(s.messageCode=this.A);const o=this.R[e];return new Promise(((r,h)=>{const a={resolve:r,reject:h};if(i?a.action=s.actionData.action:a.eventType=s.eventData.eventType,o.promiseFuncs.set(s.messageCode,a),!o.isConnected||n||i&&s.actionData.action===t.ApiOperation.IDocsGetLoadStatus||!i&&!o.eventPort){const t=new MessageChannel,{port1:n,port2:r}=t;i?o.actionPort=n:o.eventPort=n,this.initPortListener(n);const{win:h,origin:a}=this.H(e);h&&h.postMessage(s,a||"*",[r])}else i?o.actionPort.postMessage(s):o.eventPort.postMessage(s);setTimeout((()=>{h({timeout:!0})}),i&&this.asyncActions.includes(s.actionData.action)?this.k:this.S)}))}}}(t||(t={})),function(e){e.ApiOperation={PdfFindHitHighlight:"_pdf_find_hitHighlight",PdfFindClearHighlight:"_pdf_find_clearHighlight",PdfFindHitHighlightAll:"_pdf_find_hitHighlightAll",PdfLocateHighlight:"_pdf_locate_highlight"};class i extends t.IDocsDocument{constructor(t){super(t),Object.defineProperties(this,{Find:{get(){return this._find||(this._find=new n(t)),this._find}}})}}e.PDF=i;class s extends t.IDocsApp{constructor(e){super(e,t.DocumentType.PDF),Object.defineProperties(this,{ActivePDF:{get(){return this._ActivePDF||(this._ActivePDF=new i(this)),this._ActivePDF}}})}}e.APP=s;class n{constructor(t){if(!t)throw"invalid argument";this.t=t}hitHighlight(t,i,s,n){return a(this,void 0,void 0,(function*(){const o={findText:t,matchCase:i,matchWholeWord:s,highlightColor:n},r={action:e.ApiOperation.PdfFindHitHighlight,params:o},h=yield this.t.i(r);d.u.h(this,h);let a=0;return this.o||(a=h.detail),a}))}hitHighlightAll(t,i,s,n){return a(this,void 0,void 0,(function*(){const o={hlItems:t,matchCase:i,matchWholeWord:s,highlightColor:n};(null==t?void 0:t.length)<1&&(this.o="invalid arguments!");const r={action:e.ApiOperation.PdfFindHitHighlightAll,params:o},h=yield this.t.i(r);d.u.h(this,h);let a=[];return this.o||(a=h.detail),a}))}locateHighlight(t,i){return a(this,void 0,void 0,(function*(){const s={id:t,noScroll:i};t&&"string"==typeof t||(this.o="invalid arguments!");const n={action:e.ApiOperation.PdfLocateHighlight,params:s},o=yield this.t.i(n);d.u.h(this,o);let r=null;return this.o||(r=o.detail),r}))}clearHighlight(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.PdfFindClearHighlight},i=yield this.t.i(t);d.u.h(this,i);let s=!1;return this.o||(s=!0===i.detail),s}))}}}(e||(e={})),function(t){let e,i;!function(t){t[t.SlideChange=0]="SlideChange",t[t.Play=1]="Play"}(e=t.DocViewType||(t.DocViewType={})),function(t){t[t.forward=0]="forward",t[t.backward=1]="backward",t[t.effectFinish=2]="effectFinish"}(i=t.DocViewPlayAction||(t.DocViewPlayAction={}))}(i||(i={})),function(e){const i=new Set(["IDocs.Event.OnDocViewChange","PowerPoint.Event.SlideSelectionChanged","PowerPoint.Event.SlideShowOnNext","PowerPoint.Event.SlideShowOnPrevious"]);class s{constructor(t){this.t=t}GotoSlide(t){return a(this,void 0,void 0,(function*(){return!1}))}GotoNextClick(){return a(this,void 0,void 0,(function*(){return!1}))}GotoPreClick(){return a(this,void 0,void 0,(function*(){return!1}))}Play(t,e){return a(this,void 0,void 0,(function*(){return!1}))}}e.View=s;class n{constructor(t){this.t=t,Object.defineProperties(this,{View:{get(){return this._View||(this._View=new s(t)),this._View}}})}}e.SlideShowWindow=n;class o extends t.IDocsDocument{constructor(t){super(t),Object.defineProperties(this,{SlideShowWindow:{get(){return this._SlideShowWindow||(this._SlideShowWindow=new n(t)),this._SlideShowWindow}}})}}e.PowerPoint=o;class r extends t.IDocsApp{constructor(e){super(e,t.DocumentType.PRES),this._supported_events=new Set([...this._supported_events,...i]),Object.defineProperties(this,{ActivePresentation:{get(){return this._ActivePresentation||(this._ActivePresentation=new o(this)),this._ActivePresentation}}})}SetDocView(e){return a(this,void 0,void 0,(function*(){let i=!1;const s={action:t.ApiOperation.IDocsDocView,params:[e]},n=yield this.i(s);return d.u.h(this,n),this.o||(i=n.detail),i}))}}e.APP=r}(s||(s={})),function(t){let e,i,s,n,o,r,h,a,c,d,u,l;!function(t){t.MaxRowCount="1048576",t.MaxColCount="16384",t.MaxColWidth="2045",t.MaxRowHeight="546",t.MaxImportImageSize="2097152",t.DefRowHeight="20",t.DefColWidth="72",t.MaxInsertDeleteRowCount="29999"}(e=t.Constant||(t.Constant={})),function(t){t.ThickDashed="thickdashed",t.ThickDotted="thickdotted",t.ThickSolid="thicksolid",t.ThinDashed="thindashed",t.ThinDotted="thindotted",t.ThinSolid="thinsolid"}(i=t.BorderStyle||(t.BorderStyle={})),function(t){t.Center="center",t.Left="left",t.Right="right"}(s=t.AlignmentStyle||(t.AlignmentStyle={})),function(t){t.Middle="middle",t.Top="top",t.Bottom="bottom"}(n=t.VerticalAlignmentStyle||(t.VerticalAlignmentStyle={})),function(t){t.Bold="bold",t.Italic="italic",t.Underline="underline",t.Normal="normal",t.Strikethrough="strikethrough"}(o=t.FontStyle||(t.FontStyle={})),function(t){t.Arial="Arial",t.Calibri="Calibri",t["Comic Sans MS"]="Comic Sans MS",t["Courier New"]="Courier New",t.Georgia="Georgia",t["Lucida Sans Unicode"]="Lucida Sans Unicode",t.Tahoma="Tahoma",t["Times New Roman"]="Times New Roman",t["Trebuchet MS"]="Trebuchet MS",t.Verdana="Verdana",t["宋体"]="宋体",t["黑体"]="黑体",t["微软雅黑"]="微软雅黑",t["隶书"]="隶书",t["幼圆"]="幼圆",t["华文细黑"]="华文细黑",t["华文楷体"]="华文楷体",t["华文宋体"]="华文宋体",t["华文新魏"]="华文新魏",t["华文隶书"]="华文隶书",t["等线"]="等线",t["仿宋"]="仿宋",t["楷体"]="楷体",t["方正舒体"]="方正舒体",t["方正姚体"]="方正姚体"}(r=t.FontFamily||(t.FontFamily={})),function(t){t.ReadOnly="readOnly",t.Hide="hide"}(h=t.PermissionType||(t.PermissionType={})),function(t){t.Add="add",t.Remove="remove",t.Clear="clear"}(a=t.PermissionUpdateType||(t.PermissionUpdateType={})),function(t){t.All="all",t.Border="border",t.Range="range"}(c=t.NameHighLightType||(t.NameHighLightType={})),function(t){t.Workbook="workbook",t.Worksheet="worksheet"}(d=t.NamedItemScope||(t.NamedItemScope={})),function(t){t[t.xlFillDefault=0]="xlFillDefault",t[t.xlFillCopy=1]="xlFillCopy",t[t.xlFillSeries=2]="xlFillSeries"}(u=t.XlAutoFillType||(t.XlAutoFillType={})),function(t){t.Between="between",t.EqualTo="equalTo",t.GreaterThan="greaterThan",t.GreaterThanOrEqualTo="greaterThanOrEqualTo",t.LessThan="lessThan",t.LessThanOrEqualTo="lessThanOrEqualTo",t.NotBetween="notBetween",t.NotEqualTo="notEqualTo"}(l=t.DataValidationOperator||(t.DataValidationOperator={}))}(n||(n={})),function(e){const i={white:"#FFFFFF",black:"#000000",yellow:"#FFFF00",red:"#FF0000",blue:"#0000FF",green:"#008000"};let s;!function(t){t.FloatImg="FloatImg",t.CellImg="CellImg"}(s||(s={}));const o=new Set(["Workbook.Event.Change","Workbook.Event.SheetActivate","Workbook.Event.BeforeEdit","Workbook.Event.NamesAdded","Workbook.Event.NamesModified","Workbook.Event.NamesDeleted"]),r="_sheet_getSheets",h="_sheet_setActiveSheet",c="_sheet_getActiveSheet",u="_sheet_hideSheet",l="_sheet_showSheet",m="_sheet_setSheetName",v="_sheet_newSheet",f="_sheet_insertSheet",p="_sheet_deleteSheet",_="_sheet_isHiddenSheet",g="_sheet_setActiveRange",w="_sheet_range_canEdit",y="_sheet_range_getValues",x="_sheet_range_setValues",b="_sheet_range_setValue",C="_sheet_range_clearRange",T="_sheet_range_getColors",I="_sheet_range_setColor",S="_sheet_range_merge",k="_sheet_range_mergeAcross",R="_sheet_range_mergeCenter",N="_sheet_range_getMergedRanges",P="_sheet_range_setFontFamily",O="_sheet_range_setFontSize",F="_sheet_range_setWrap",E="_sheet_range_setFontStyle",A="_sheet_range_setAlignment",D="_sheet_range_setVerticalAlignment",j="_sheet_range_setBorder",M="_sheet_range_getHtml",H="_sheet_range_autoFill",B="_sheet_getSheetIndex",G="_sheet_isValidSheet",L="_sheet_getActiveRange",W="_sheet_setFreezeRow",V="_sheet_setFreezeCol",U="_sheet_getFreezeRow",$="_sheet_getFreezeCol",z="_sheet_hideRow",J="_sheet_hideRows",q="_sheet_showRow",K="_sheet_showRows",Y="_sheet_insertCol",X="_sheet_insertCols",Z="_sheet_deleteCol",Q="_sheet_deleteCols",tt="_sheet_insertRow",et="_sheet_insertRows",it="_sheet_deleteRow",st="_sheet_deleteRows",nt="_sheet_hideCol",ot="_sheet_hideCols",rt="_sheet_showCol",ht="_sheet_showCols",at="_sheet_setRowHeight",ct="_sheet_setRowHeights",dt="_sheet_setColWidth",ut="_sheet_setColWidths",lt="_sheet_getColWidth",mt="_sheet_getRowHeight",vt="_sheet_insertImageWithUrl",ft="_sheet_insertImageWithBlob",pt="_sheet_insertCellImageWithBlob",_t="_sheet_insertCellImageWithUrl",gt="_sheet_names_count",wt="_sheet_names_add",yt="_sheet_names_add_userDefined",xt="_sheet_names_item",bt="_sheet_names_item_delete",Ct="_sheet_names_item_focus",Tt="_sheet_names_item_highLight",It="_sheet_names_item_update",St="_sheet_names_item_range",kt="_sheet_permissions_count",Rt="_sheet_permissions_item",Nt="_sheet_permissions_add",Pt="_sheet_permission_delete",Ot="_sheet_permission_update_users",Ft="_sheet_permission_info",Et="_sheet_shapes_count",At="_sheet_shapes_item",Dt="_sheet_shapes_item_getImageDataURL",jt="_sheet_printOut",Mt="_sheet_dataValidation_edit",Ht="_sheet_dataValidation_delete",Bt="_sheet_workbook_protect",Gt="_sheet_workbook_unprotect",Lt="_sheet_workbook_getProtected";class Wt{constructor(t,e,i,s,o){if(!t)throw"invalid arguments";if("number"!=typeof e||"number"!=typeof s||"number"!=typeof i||"number"!=typeof o||e>s||i>o||o>Number(n.Constant.MaxColCount)||s>Number(n.Constant.MaxRowCount)||e<1||i<1||e%1!=0||s%1!=0||i%1!=0||o%1!=0)throw"invalid arguments";this.it=t,this.st=e,this.nt=i,this.ot=s,this.rt=o,this.o=null}get row(){return this.st}get column(){return this.nt}get endRow(){return this.ot}get endColumn(){return this.rt}getSheet(){return this.it}getErrMessage(){return this.o}getCell(t,e){const i=this.row+t-1,s=this.column+e-1;if(i<this.row||i>this.endRow)return null;if(s<this.column||s>this.endColumn)return null;if(this.row===this.endRow&&this.column===this.endColumn)return this;return new Wt(this.it,i,s,i,s)}getRow(){return new Wt(this.it,this.row,this.column,this.row,this.endColumn)}getEndRow(){return new Wt(this.it,this.endRow,this.column,this.endRow,this.endColumn)}getColumn(){return new Wt(this.it,this.row,this.column,this.endRow,this.column)}getEndColumn(){return new Wt(this.it,this.row,this.endColumn,this.endRow,this.endColumn)}activate(){return a(this,void 0,void 0,(function*(){yield this.it.setActiveRange(this)}))}canEdit(){return a(this,void 0,void 0,(function*(){const t={action:w,params:{sheetName:this.it.name,row:this.row,column:this.column,endRow:this.endRow,endColumn:this.endColumn}},e=yield this.it.t.i(t);d.u.h(this,e);let i=!1;return this.o||(i=e.detail),i}))}getShowValue(){return a(this,void 0,void 0,(function*(){const t={action:y,params:{sheetName:this.it.name,row:this.row,column:this.column,endRow:this.row,endColumn:this.column,bShowValue:!0}},e=yield this.it.t.i(t);d.u.h(this,e);let i="";return this.o||(i=e.detail&&e.detail.length&&e.detail[0].length?e.detail[0][0]:""),i}))}getShowValues(){return a(this,void 0,void 0,(function*(){const t={action:y,params:{sheetName:this.it.name,row:this.row,column:this.column,endRow:this.endRow,endColumn:this.endColumn,bShowValue:!0}},e=yield this.it.t.i(t);let i;return d.u.h(this,e),this.o||(i=e.detail),i}))}getValue(){return a(this,void 0,void 0,(function*(){const t={action:y,params:{sheetName:this.it.name,row:this.row,column:this.column,endRow:this.row,endColumn:this.column,bShowValue:!1}},e=yield this.it.t.i(t);let i;return d.u.h(this,e),this.o||(i=e.detail&&e.detail.length&&e.detail[0].length?e.detail[0][0]:""),i}))}getValues(){return a(this,void 0,void 0,(function*(){const t={action:y,params:{sheetName:this.it.name,row:this.row,column:this.column,endRow:this.endRow,endColumn:this.endColumn,bShowValue:!1}},e=yield this.it.t.i(t);let i;return d.u.h(this,e),this.o||(i=e.detail),i}))}getVisibleValues(){return a(this,void 0,void 0,(function*(){const t={action:y,params:{sheetName:this.it.name,row:this.row,column:this.column,endRow:this.endRow,endColumn:this.endColumn,bShowValue:!1,bHidden:!0}},e=yield this.it.t.i(t);let i;return d.u.h(this,e),this.o||(i=e.detail),i}))}setValue(t){return a(this,void 0,void 0,(function*(){const e={action:b,params:{sheetName:this.it.name,row:this.row,column:this.column,endRow:this.row,endColumn:this.column,value:t}},i=yield this.it.t.i(e);d.u.h(this,i)}))}setValues(t){return a(this,void 0,void 0,(function*(){if(!this.ht(t,(t=>!(t&&"number"!=typeof t&&"string"!=typeof t&&"boolean"!=typeof t))))return void(this.o="invalid argument");const e={action:x,params:{values:t,row:this.row,column:this.column,endRow:this.endRow,endColumn:this.endColumn,sheetName:this.it.name}},i=yield this.it.t.i(e);d.u.h(this,i)}))}clearContent(){return a(this,void 0,void 0,(function*(){const t=this.it.name,e={action:C,params:{sheetName:t,row:this.row,column:this.column,endRow:this.endRow,endColumn:this.endColumn}},i=yield this.it.t.i(e);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))}getBackground(){return a(this,void 0,void 0,(function*(){const t=yield this.ct(this.row,this.column,this.row,this.column,!0);return t[this.row]&&t[this.row].length?t[this.row][0]:"transparent"}))}getBackgrounds(){return a(this,void 0,void 0,(function*(){return yield this.ct(this.row,this.column,this.endRow,this.endColumn,!0)}))}setBackground(t){return a(this,void 0,void 0,(function*(){t&&7===t.length&&"#"===t.charAt(0)?yield this.dt([[t]],!0):this.o="invalid argument"}))}setBackgrounds(t){return a(this,void 0,void 0,(function*(){this.ht(t,(t=>!(t&&"string"!=typeof t&&7!==t.length&&"#"!==t.charAt(0))))?yield this.dt(t,!0):this.o="invalid argument"}))}getFontColor(){return a(this,void 0,void 0,(function*(){const t=yield this.ct(this.row,this.column,this.row,this.column,!1);return t[this.row]&&t[this.row].length?t[this.row][0]:"#000000"}))}getFontColors(){return a(this,void 0,void 0,(function*(){return yield this.ct(this.row,this.column,this.endRow,this.endColumn,!1)}))}setFontColor(t){return a(this,void 0,void 0,(function*(){t&&7===t.length&&"#"===t.charAt(0)?yield this.dt([[t]],!1):this.o="invalid argument"}))}setFontColors(t){return a(this,void 0,void 0,(function*(){this.ht(t,(t=>!(t&&"string"!=typeof t&&7!==t.length&&"#"!==t.charAt(0))))?yield this.dt(t,!1):this.o="invalid argument"}))}ht(t,e){if(!t||!Array.isArray(t))return!1;if(t.length>this.endRow-this.row+1)return!1;let i=!0;const s=this.endColumn-this.column+1;for(let n=0;n<t.length;n+=1){const o=t[n];if(o){if(!Array.isArray(o)||o.length>s){i=!1;break}for(let t=0;t<o.length;t+=1){if(!e(o[t])){i=!1;break}}if(!i)break}}return i}ct(t,e,i,s,n){return a(this,void 0,void 0,(function*(){const o={action:T,params:{row:t,column:e,endRow:i,endColumn:s,bBackground:n,sheetName:this.it.name}},r=yield this.it.t.i(o);let h;return d.u.h(this,r),this.o||(h=r.detail),h}))}dt(t,e){return a(this,void 0,void 0,(function*(){const i=this.it.name,s={action:I,params:{sheetName:i,bBackground:e,color:t,row:this.row,column:this.column,endRow:this.endColumn,endColumn:this.endColumn}},n=yield this.it.t.i(s);d.u.h(this,n)}))}merge(){return a(this,void 0,void 0,(function*(){const t={action:S,params:{sheetName:this.it.name,row:this.st,column:this.nt,endRow:this.ot,endColumn:this.rt,bAcross:!1,bCenter:!1}},e=yield this.it.t.i(t);let i;return d.u.h(this,e),this.o||(i=e.detail),i}))}mergeAndCenter(){return a(this,void 0,void 0,(function*(){const t={action:R,params:{sheetName:this.it.name,row:this.st,column:this.nt,endRow:this.ot,endColumn:this.rt,bAcross:!1,bCenter:!0}},e=yield this.it.t.i(t);let i;return d.u.h(this,e),this.o||(i="success"===e.status),i}))}mergeAcross(){return a(this,void 0,void 0,(function*(){const t={action:k,params:{sheetName:this.it.name,row:this.st,column:this.nt,endRow:this.ot,endColumn:this.rt,bAcross:!0,bCenter:!1}},e=yield this.it.t.i(t);let i;return d.u.h(this,e),this.o||(i="success"===e.status),i}))}getMergedRanges(){return a(this,void 0,void 0,(function*(){const t={action:N,params:{sheetName:this.it.name,row:this.st,column:this.nt,endRow:this.ot,endColumn:this.rt}},e=yield this.it.t.i(t);let i;if(d.u.h(this,e),this.o||(i="success"===e.status),i&&"boolean"!=typeof e.detail){const t=[];return e.detail.forEach(((e,i)=>{const s=this.it,n=e.start.row,o=e.start.col,r=e.end.row,h=e.end.col;t[i]=new Wt(s,n,o,r,h)})),t}return e.detail}))}setFontFamily(t){return a(this,void 0,void 0,(function*(){if(!Object.values(n.FontFamily).includes(t))throw"Invalid font family!";const e={action:P,params:{sheetName:this.it.name,row:this.st,column:this.nt,endRow:this.ot,endColumn:this.rt,fontFamily:t}},i=yield this.it.t.i(e);let s;return d.u.h(this,i),this.o||(s="success"===i.status),s}))}setFontSize(t){return a(this,void 0,void 0,(function*(){if("number"!=typeof t||t<8||t>72)throw"Invalid font size!";const e=parseInt(t.toString()),i=t-e;if(0!==i&&.5!==i)throw"Invalid font size!";const s={action:O,params:{sheetName:this.it.name,row:this.st,column:this.nt,endRow:this.ot,endColumn:this.rt,fontSize:t}},n=yield this.it.t.i(s);let o;return d.u.h(this,n),this.o||(o="success"===n.status),o}))}setWrap(t){return a(this,void 0,void 0,(function*(){if("boolean"!=typeof t)throw"Invalid arguments!";const e={action:F,params:{sheetName:this.it.name,row:this.st,column:this.nt,endRow:this.ot,endColumn:this.rt,isWrapEnabled:t}},i=yield this.it.t.i(e);let s;return d.u.h(this,i),this.o||(s="success"===i.status),s}))}setFontStyle(t){return a(this,void 0,void 0,(function*(){if(!Object.values(n.FontStyle).includes(t))throw"invalid font style!";const e={action:E,params:{sheetName:this.it.name,row:this.st,column:this.nt,endRow:this.ot,endColumn:this.rt,fontStyle:t}},i=yield this.it.t.i(e);let s;return d.u.h(this,i),this.o||(s="success"===i.status),s}))}setAlignment(t){return a(this,void 0,void 0,(function*(){if(!Object.values(n.AlignmentStyle).includes(t))throw"invalid alignment!";const e={action:A,params:{sheetName:this.it.name,row:this.st,column:this.nt,endRow:this.ot,endColumn:this.rt,alignment:t}},i=yield this.it.t.i(e);let s;return d.u.h(this,i),this.o||(s="success"===i.status),s}))}setVerticalAlignment(t){return a(this,void 0,void 0,(function*(){if(!Object.values(n.VerticalAlignmentStyle).includes(t))throw"invalid vertical alignment!";const e={action:D,params:{sheetName:this.it.name,row:this.st,column:this.nt,endRow:this.ot,endColumn:this.rt,verticalAlignment:t}},i=yield this.it.t.i(e);let s;return d.u.h(this,i),this.o||(s="success"===i.status),s}))}setBorder(t,e,s,o,r,h,c,u){return a(this,void 0,void 0,(function*(){let a=c;if(i[c]&&(a=i[c]),!a||7!==a.length||"#"!==a.charAt(0))throw"invalid color!";if(u&&!Object.values(n.BorderStyle).includes(u))throw"invalid border format!";const l={borderAttrs:{top:t,left:e,bottom:s,right:o,vertical:r,horizontal:h,borderFormat:u,color:a},sheetName:this.it.name,row:this.st,column:this.nt,endRow:this.ot,endColumn:this.rt},m={action:j,params:l},v=yield this.it.t.i(m);let f;return d.u.h(this,v),this.o||(f="success"===v.status),f}))}getHtml(t=!1){return a(this,void 0,void 0,(function*(){const e=this.getSheet().name,i=this.row,s=this.column,n=this.endRow,o=this.endColumn,r={action:M,params:{sheetName:e,row:i,column:s,endRow:n,endColumn:o,dataOnly:t}},h=yield this.it.t.i(r);let a;return d.u.h(this,h),this.o||(a=h.detail),a}))}autoFill(t,e){return a(this,void 0,void 0,(function*(){if(!(t&&t instanceof Wt))throw"Please enter the correct destination!";const i={startRow:this.row,startCol:this.column,endRow:this.endRow,endCol:this.endColumn,sheetName:this.it.name},s={startRow:t.row,startCol:t.column,endRow:t.endRow,endCol:t.endColumn,sheetName:t.it.name},n={action:H,params:{originData:i,destinationData:s,type:e}},o=yield this.it.t.i(n);d.u.h(this,o)}))}getDataValidation(){return this.ut||(this.ut=new oe(this.it,this)),this.ut}}class Vt{constructor(t,e){this.lt=t,this.t=e,Object.defineProperties(this,{Names:{get(){return this.vt||(this.vt=new Jt(this.t,this.lt)),this.vt}}}),Object.defineProperties(this,{RangePermissions:{get(){return this.ft||(this.ft=new Xt(this)),this.ft}}}),Object.defineProperties(this,{Shapes:{get(){if(!this._t){const t=new Wt(this,1,1,Number(n.Constant.MaxRowCount),Number(n.Constant.MaxColCount));this._t=new ee(this.t,t)}return this._t}}})}getApp(){return this.t}getErrMessage(){return this.o}get name(){return this.lt}static gt(t,e,i=!1){if("number"!=typeof t)return!1;if(i){if(t<0||t%1!=0)return!1}else if(t<=0||t%1!=0)return!1;if(e){if(t>Number(n.Constant.MaxRowCount))return!1}else if(t>Number(n.Constant.MaxColCount))return!1;return!0}static wt(t,e,i){return!(!this.gt(t,i)||!this.gt(e,i))&&!(t>e)}static yt(t){return"number"==typeof t&&!(t>Number(n.Constant.MaxRowHeight)||t<0)}static xt(t){return"number"==typeof t&&!(t>Number(n.Constant.MaxColWidth)||t<0)}static isValidOffset(t,e){return"number"==typeof t&&(e?t>0&&t<Number(n.Constant.DefRowHeight):t>0&&t<Number(n.Constant.DefColWidth))}static bt(t,e){return"number"==typeof t&&(!(t<=0||t%1!=0)&&(e?t<Number(n.Constant.MaxInsertDeleteRowCount):t<Number(n.Constant.MaxColCount)-1))}delete(){return a(this,void 0,void 0,(function*(){const t={action:p,params:{sheetName:this.lt}},e=yield this.t.i(t);d.u.h(this,e);let i=!1;return this.o||(i=e.detail),i}))}activate(){return a(this,void 0,void 0,(function*(){const t={action:h,params:{sheetName:this.name}},e=yield this.t.i(t);d.u.h(this,e)}))}hide(){return a(this,void 0,void 0,(function*(){const t={action:u,params:{sheetName:this.name,bVisible:!1}},e=yield this.t.i(t);let i;return d.u.h(this,e),this.o||(i=e.detail),i}))}show(){return a(this,void 0,void 0,(function*(){const t={action:l,params:{sheetName:this.name,bVisible:!0}},e=yield this.t.i(t);let i;return d.u.h(this,e),this.o||(i=e.detail),i}))}setName(t){return a(this,void 0,void 0,(function*(){if(!t)return void(this.o="invalid argument");const e={action:m,params:{sheetName:this.name,rName:t}},i=yield this.t.i(e);let s;return d.u.h(this,i),this.o||(s=i.detail,s&&(delete this.t.ActiveWorkbook.sheets[this.lt],this.lt=t,this.t.ActiveWorkbook.sheets[this.lt]=this)),s}))}isHidden(){return a(this,void 0,void 0,(function*(){const t={action:_,params:{sheetName:this.name}},e=yield this.t.i(t);d.u.h(this,e);let i=!1;return this.o||(i=e.detail),i}))}getIndex(){return a(this,void 0,void 0,(function*(){const t={action:B,params:{sheetName:this.name}},e=yield this.t.i(t);let i;return d.u.h(this,e),this.o||(i=e.detail),i}))}getActiveCell(){return a(this,void 0,void 0,(function*(){const t={action:L,params:{sheetName:this.name}},e=yield this.t.i(t);let i;if(d.u.h(this,e),!this.o){const t=e.detail;i=new Wt(this,t.row,t.column,t.row,t.column)}return i}))}getActiveRange(){return a(this,void 0,void 0,(function*(){const t={action:L,params:{sheetName:this.name}},e=yield this.t.i(t);let i;if(d.u.h(this,e),!this.o){const t=e.detail;i=new Wt(this,t.row,t.column,t.endRow,t.endColumn)}return i}))}setActiveRange(t){return a(this,void 0,void 0,(function*(){if(!t)return void(this.o="invalid argument");const e={action:g,params:{sheetName:this.name,row:t.row,column:t.column,endRow:t.endRow,endColumn:t.endColumn}},i=yield this.t.i(e);d.u.h(this,i)}))}setFreezeRow(t){return a(this,void 0,void 0,(function*(){if(!Vt.gt(t,!0,!0))return!1;const e={action:W,params:{rowIndex:t,sheetName:this.name}},i=yield this.t.i(e);d.u.h(this,i);let s=!1;return this.o||(s=i.status,s&&(s=!0)),s}))}getFreezeRow(){return a(this,void 0,void 0,(function*(){const t={action:U,params:{sheetName:this.name}},e=yield this.t.i(t);let i;return d.u.h(this,e),this.o||(i=e.detail),i}))}setFreezeColumn(t){return a(this,void 0,void 0,(function*(){if(!Vt.gt(t,!1,!0))return!1;const e={action:V,params:{colIndex:t,sheetName:this.name}},i=yield this.t.i(e);d.u.h(this,i);let s=!1;return this.o||(s=i.status,s&&(s=!0)),s}))}getFreezeColumn(){return a(this,void 0,void 0,(function*(){const t={action:$,params:{sheetName:this.name}},e=yield this.t.i(t);let i;return d.u.h(this,e),this.o||(i=e.detail),i}))}hideRow(t){return a(this,void 0,void 0,(function*(){if(!Vt.gt(t,!0))return!1;const e={action:z,params:{startColIndex:0,startRowIndex:t-1,sheetName:this.name,endColIndex:Number(n.Constant.MaxColCount)-1,endRowIndex:t-1}},i=yield this.t.i(e);d.u.h(this,i);let s=!1;return this.o||(s=i.status,s&&(s=!0)),s}))}insertRow(t){return a(this,void 0,void 0,(function*(){if(!Vt.gt(t,!0))return!1;const e={action:tt,params:{howmany:1,sheetName:this.name,rowIndex:t}},i=yield this.t.i(e);d.u.h(this,i);let s=!1;return this.o||"success"===i.status&&(s=i.detail),s}))}insertRows(t,e){return a(this,void 0,void 0,(function*(){if(!Vt.gt(t,!0))return!1;if(!Vt.bt(e,!0))return!1;const i={action:et,params:{sheetName:this.name,howmany:e,rowIndex:t}},s=yield this.t.i(i);d.u.h(this,s);let n=!1;return this.o||"success"===s.status&&(n=s.detail),n}))}deleteRow(t){return a(this,void 0,void 0,(function*(){if(!Vt.gt(t,!0))return!1;const e={action:it,params:{howmany:1,sheetName:this.name,rowIndex:t}},i=yield this.t.i(e);d.u.h(this,i);let s=!1;return this.o||"success"===i.status&&(s=i.detail),s}))}deleteRows(t,e){return a(this,void 0,void 0,(function*(){if(!Vt.gt(t,!0))return!1;if(!Vt.bt(e,!0))return!1;const i={action:st,params:{sheetName:this.name,howmany:e,rowIndex:t}},s=yield this.t.i(i);d.u.h(this,s);let n=!1;return this.o||"success"===s.status&&(n=s.detail),n}))}insertColumn(t){return a(this,void 0,void 0,(function*(){if(!Vt.gt(t,!0))return!1;const e={action:Y,params:{howmany:1,sheetName:this.name,colIndex:t}},i=yield this.t.i(e);d.u.h(this,i);let s=!1;return this.o||"success"===i.status&&(s=i.detail),s}))}insertColumns(t,e){return a(this,void 0,void 0,(function*(){if(!Vt.gt(t,!0))return!1;if(!Vt.bt(e,!0))return!1;const i={action:X,params:{sheetName:this.name,howmany:e,colIndex:t}},s=yield this.t.i(i);d.u.h(this,s);let n=!1;return this.o||"success"===s.status&&(n=s.detail),n}))}deleteColumn(t){return a(this,void 0,void 0,(function*(){if(!Vt.gt(t,!0))return!1;const e={action:Z,params:{howmany:1,sheetName:this.name,colIndex:t}},i=yield this.t.i(e);d.u.h(this,i);let s=!1;return this.o||"success"===i.status&&(s=i.detail),s}))}deleteColumns(t,e){return a(this,void 0,void 0,(function*(){if(!Vt.gt(t,!0))return!1;if(!Vt.bt(e,!0))return!1;const i={action:Q,params:{sheetName:this.name,howmany:e,colIndex:t}},s=yield this.t.i(i);d.u.h(this,s);let n=!1;return this.o||"success"===s.status&&(n=s.detail),n}))}hideRows(t,e){return a(this,void 0,void 0,(function*(){if(!Vt.wt(t,e,!0))return!1;const i={action:J,params:{startColIndex:0,startRowIndex:t-1,sheetName:this.name,endColIndex:Number(n.Constant.MaxColCount)-1,endRowIndex:e-1}},s=yield this.t.i(i);d.u.h(this,s);let o=!1;return this.o||(o=s.status,o&&(o=!0)),o}))}showRow(t){return a(this,void 0,void 0,(function*(){if(!Vt.gt(t,!0))return!1;const e={action:q,params:{startColIndex:0,startRowIndex:t-1,sheetName:this.name,endColIndex:Number(n.Constant.MaxColCount)-1,endRowIndex:t-1,bShow:!0}},i=yield this.t.i(e);d.u.h(this,i);let s=!1;return this.o||(s=i.status,s&&(s=!0)),s}))}showRows(t,e){return a(this,void 0,void 0,(function*(){if(!Vt.wt(t,e,!0))return!1;const i={action:K,params:{startColIndex:0,startRowIndex:t-1,sheetName:this.name,endColIndex:Number(n.Constant.MaxColCount)-1,endRowIndex:e-1,bShow:!0}},s=yield this.t.i(i);d.u.h(this,s);let o=!1;return this.o||(o=s.status,o&&(o=!0)),o}))}hideColumn(t){return a(this,void 0,void 0,(function*(){if(!Vt.gt(t,!1))return!1;const e={action:nt,params:{startColIndex:t-1,startRowIndex:0,sheetName:this.name,endColIndex:t-1,endRowIndex:Number(n.Constant.MaxRowCount)-1}},i=yield this.t.i(e);d.u.h(this,i);let s=!1;return this.o||(s=i.status,s&&(s=!0)),s}))}hideColumns(t,e){return a(this,void 0,void 0,(function*(){if(!Vt.wt(t,e,!1))return!1;const i={action:ot,params:{startColIndex:t-1,startRowIndex:0,sheetName:this.name,endColIndex:e-1,endRowIndex:Number(n.Constant.MaxRowCount)-1}},s=yield this.t.i(i);d.u.h(this,s);let o=!1;return this.o||(o=s.status,o&&(o=!0)),o}))}showColumn(t){return a(this,void 0,void 0,(function*(){if(!Vt.gt(t,!1))return!1;const e={action:rt,params:{startColIndex:t-1,startRowIndex:0,sheetName:this.name,endColIndex:t-1,endRowIndex:Number(n.Constant.MaxRowCount)-1,bShow:!0}},i=yield this.t.i(e);d.u.h(this,i);let s=!1;return this.o||(s=i.status,s&&(s=!0)),s}))}showColumns(t,e){return a(this,void 0,void 0,(function*(){if(!Vt.wt(t,e,!1))return!1;const i={action:ht,params:{startColIndex:t-1,startRowIndex:0,sheetName:this.name,endColIndex:e-1,endRowIndex:Number(n.Constant.MaxRowCount)-1,bShow:!0}},s=yield this.t.i(i);d.u.h(this,s);let o=!1;return this.o||(o=s.status,o&&(o=!0)),o}))}setColumnWidth(t,e){return a(this,void 0,void 0,(function*(){if(!Vt.gt(t,!1)||!Vt.xt(e))return!1;const i={action:dt,params:{startColIndex:t-1,startRowIndex:0,sheetName:this.name,endColIndex:t-1,endRowIndex:Number(n.Constant.MaxRowCount)-1,width:e}},s=yield this.t.i(i);d.u.h(this,s);let o=!1;return this.o||(o=s.status,o&&(o=!0)),o}))}setColumnWidths(t,e,i){return a(this,void 0,void 0,(function*(){if(!Vt.wt(t,e,!1)||!Vt.xt(i))return!1;const s={action:ut,params:{startColIndex:t-1,startRowIndex:0,sheetName:this.name,endColIndex:e-1,endRowIndex:Number(n.Constant.MaxRowCount)-1,width:i}},o=yield this.t.i(s);d.u.h(this,o);let r=!1;return this.o||(r=o.status,r&&(r=!0)),r}))}setRowHeight(t,e){return a(this,void 0,void 0,(function*(){if(!Vt.gt(t,!0)||!Vt.yt(e))return!1;const i={action:at,params:{startColIndex:0,startRowIndex:t-1,sheetName:this.name,endColIndex:Number(n.Constant.MaxColCount)-1,endRowIndex:t-1,height:e}},s=yield this.t.i(i);d.u.h(this,s);let o=!1;return this.o||(o=s.status,o&&(o=!0)),o}))}setRowHeights(t,e,i){return a(this,void 0,void 0,(function*(){if(!Vt.wt(t,e,!0)||!Vt.yt(i))return!1;const s={action:ct,params:{startColIndex:0,startRowIndex:t-1,sheetName:this.name,endColIndex:Number(n.Constant.MaxColCount)-1,endRowIndex:e-1,height:i}},o=yield this.t.i(s);d.u.h(this,o);let r=!1;return this.o||(r=o.status,r&&(r=!0)),r}))}getRowHeight(t){return a(this,void 0,void 0,(function*(){if(!Vt.gt(t,!0))return-1;const e={action:mt,params:{rowIndex:t,sheetName:this.name}},i=yield this.t.i(e);return d.u.h(this,i),i.detail}))}getColumnWidth(t){return a(this,void 0,void 0,(function*(){if(!Vt.gt(t,!1))return-1;const e={action:lt,params:{colIndex:t,sheetName:this.name}},i=yield this.t.i(e);return d.u.h(this,i),i.detail}))}insertImage(t,e,i,o,r){return a(this,void 0,void 0,(function*(){if(!Vt.gt(i,!1)||!Vt.gt(e,!0))throw"Invalid arguments!";if(!Vt.isValidOffset(o,!0)||!Vt.isValidOffset(r,!1))throw"Invalid offset!";let h;if(t instanceof Blob){const a=t;if(a.size>Number(n.Constant.MaxImportImageSize))throw"Image size is too large!";h={action:ft,params:{blobSource:a,offsetX:o,offsetY:r,row:e,column:i,sheetName:this.name,imageType:s.FloatImg}}}else if("string"==typeof t){h={action:vt,params:{imageUrl:t,offsetX:o,offsetY:r,row:e,column:i,sheetName:this.name,imageType:s.FloatImg}}}const a=yield this.t.i(h);return d.u.h(this,a),a.detail}))}insertCellImage(t,e,i){return a(this,void 0,void 0,(function*(){if(!Vt.gt(i,!1)||!Vt.gt(e,!0))throw"Invalid arguments!";let o;if(t instanceof Blob){const r=t;if(r.size>Number(n.Constant.MaxImportImageSize))throw"Image size is too large!";o={action:pt,params:{blobSource:r,row:e,column:i,sheetName:this.name,imageType:s.CellImg}}}else if("string"==typeof t){o={action:_t,params:{imageUrl:t,row:e,column:i,sheetName:this.name,imageType:s.CellImg}}}const r=yield this.t.i(o);return d.u.h(this,r),r.detail}))}getRange(t,e,i,s){return new Wt(this,t,e,i,s)}insertSheet(t){return a(this,void 0,void 0,(function*(){if(!t)return void(this.o="invalid argument");const e={action:f,params:{sheetName:this.name,rName:t}},i=yield this.t.i(e);d.u.h(this,i);let s=!1;return this.o||(s=i.detail),s&&(this.t.ActiveWorkbook.sheets[t]=new Vt(t,this.t)),s}))}getHtml(t=!1){return a(this,void 0,void 0,(function*(){const e=this.name,i=Number(n.Constant.MaxRowCount),s=Number(n.Constant.MaxColCount),o={action:M,params:{sheetName:e,row:1,column:1,endRow:i,endColumn:s,dataOnly:t}},r=yield this.t.i(o);let h;return d.u.h(this,r),this.o||(h=r.detail),h}))}}e.Sheet=Vt;class Ut extends t.IDocsDocument{constructor(t){super(t),this.sheets={},Object.defineProperties(this,{Names:{get(){return this.vt||(this.vt=new Jt(this.t)),this.vt}}}),Object.defineProperties(this,{SheetPermissions:{get(){return this.Ct||(this.Ct=new Qt(this)),this.Ct}}}),Object.defineProperties(this,{ContentFrames:{get(){return this._contentFrames||(this._contentFrames=new se(this.t)),this._contentFrames}}}),Object.defineProperties(this,{Protection:{get(){return this.Tt||(this.Tt=new $t(this)),this.Tt}}})}getNameRanges(t=!1){return a(this,void 0,void 0,(function*(){return t?new Jt(this.t,null,!0):(this.vt||(this.vt=new Jt(this.t)),this.vt)}))}getActiveSheet(){return a(this,void 0,void 0,(function*(){const t={action:c,params:{}},e=yield this.t.i(t);let i;if(d.u.h(this,e),!this.o){const t=e.detail;i=this.sheets[t],i||(i=new Vt(t,this.t),this.sheets[t]=i)}return i}))}getSheets(){return a(this,void 0,void 0,(function*(){const t={action:r,params:{}},e=yield this.t.i(t),i=[];if(d.u.h(this,e),!this.o){const t=e.detail;for(const e in t){const s=t[e];this.sheets[s]=new Vt(s,this.t),i.push(this.sheets[s])}}return i}))}getSheetByName(t){return a(this,void 0,void 0,(function*(){if(!t)return void(this.o="invalid argument");const e={action:G,params:{sheetName:t}},i=yield this.t.i(e);let s;if(d.u.h(this,i),!this.o){const t=i.detail;t?this.sheets[t]?s=this.sheets[t]:(s=new Vt(t,this.t),this.sheets[t]=s):delete this.sheets[t]}return s}))}newSheet(t){return a(this,void 0,void 0,(function*(){if(!t)return void(this.o="invalid argument");const e={action:v,params:{rName:t}},i=yield this.t.i(e);d.u.h(this,i);let s=!1;return this.o||(s=i.detail),s&&(this.sheets[t]=new Vt(t,this.t)),s}))}print(){return a(this,void 0,void 0,(function*(){const t={action:jt,params:{status:"startPrint"}},e=yield this.t.i(t);return d.u.h(this,e),!(this.o||!e.detail)}))}getProtection(){return new $t(this)}}e.Workbook=Ut;class $t extends Ut{constructor(t){super(t.t),Object.defineProperties(this,{isProtected:{get(){return a(this,void 0,void 0,(function*(){const t=yield this.getProtection();return yield t.getProtected()}))}}})}protect(t){return a(this,void 0,void 0,(function*(){const t={action:Bt,params:{data:{protectStruct:!0}}},e=yield this.t.i(t);d.u.h(this,e)}))}unprotect(t){return a(this,void 0,void 0,(function*(){const t={action:Gt,params:{data:{protectStruct:!1}}},e=yield this.t.i(t);d.u.h(this,e)}))}getProtected(){return a(this,void 0,void 0,(function*(){const t={action:Lt,params:{}},e=yield this.t.i(t);if(d.u.h(this,e),!this.o){return e.detail}return null}))}}e.WorkBookProtection=$t;class zt extends t.IDocsApp{constructor(e){super(e,t.DocumentType.SHEET),this._supported_events=new Set([...this._supported_events,...o]),Object.defineProperties(this,{ActiveWorkbook:{get(){return this._ActiveWorkbook||(this._ActiveWorkbook=new Ut(this)),this._ActiveWorkbook}},ActiveWindow:{get(){return this._ActiveWindow||(this._ActiveWindow=new t.ActiveWindow(this)),this._ActiveWindow}}})}}e.APP=zt;class Jt{constructor(t,e,i){this.It=!1,this.t=t,e&&(this.St=e),i&&(this.It=!0),Object.defineProperties(this,{count:{get(){return a(this,void 0,void 0,(function*(){const t={action:gt,params:{sheetName:this.St,bTypeRange:this.It}},e=yield this.t.i(t);let i=0;return d.u.h(this,e),this.o||(i=e.detail),i}))}}})}add(t,e,i=!1){return a(this,void 0,void 0,(function*(){if(!t||!e)return;const s={aName:t,address:e,sheetName:this.St};let n=wt;i&&(s.type="insert",n=yt);const o={action:n,params:s},r=yield this.t.i(o);return d.u.h(this,r),!this.o&&r.detail?new qt(this.t,r.detail):void 0}))}item(t){var e;return a(this,void 0,void 0,(function*(){if(!t||"string"!=typeof t&&"number"!=typeof t)return;const i={action:xt,params:{index:t,sheetName:this.St,bTypeRange:this.It}},s=yield this.t.i(i);let n;return d.u.h(this,s),!this.o&&(null===(e=s.detail)||void 0===e?void 0:e.id)&&(n=new qt(this.t,s.detail)),n}))}addHighLight(t,e,i){return a(this,void 0,void 0,(function*(){yield this.kt(t,e,i,"add")}))}removeHighLight(t,e){return a(this,void 0,void 0,(function*(){yield this.kt(t,e,null,"remove")}))}kt(t,e,i,s){return a(this,void 0,void 0,(function*(){const n={action:Tt,params:{nameIds:t,type:e,color:i,action:s}},o=yield this.t.i(n);d.u.h(this,o)}))}}e.Names=Jt;class qt{constructor(t,e){this.t=t,this.Rt=null==e?void 0:e.id,this.Nt=null==e?void 0:e.name,this.Pt=null==e?void 0:e.value,this.Ot=null==e?void 0:e.sheetScope,this.St=null==e?void 0:e.sheetName,this.scope=(null==e?void 0:e.sheetScope)?n.NamedItemScope.Worksheet:n.NamedItemScope.Workbook,this.visible=!!(null==e?void 0:e.visible),Object.defineProperties(this,{name:{get(){var t;return a(this,void 0,void 0,(function*(){const e=yield this.getNameData();return null===(t=null==e?void 0:e.detail)||void 0===t?void 0:t.name}))}}}),Object.defineProperties(this,{value:{get(){var t;return a(this,void 0,void 0,(function*(){const e=yield this.getNameData();return null===(t=null==e?void 0:e.detail)||void 0===t?void 0:t.value}))}}}),Object.defineProperties(this,{worksheet:{get(){return a(this,void 0,void 0,(function*(){if(!(null==e?void 0:e.sheetName))return;return yield t.ActiveWorkbook.getSheetByName(null==e?void 0:e.sheetName)}))}}}),Object.defineProperties(this,{range:{get(){return a(this,void 0,void 0,(function*(){const e={action:St,params:{id:this.Rt,sheetName:this.St}},i=yield this.t.i(e);if(d.u.h(this,i),!i.detail)return;const{sheetName:s,startRow:n,startCol:o,endRow:r,endCol:h}=i.detail;return(yield t.ActiveWorkbook.getSheetByName(s)).getRange(n,o,r,h)}))}}})}delete(){return a(this,void 0,void 0,(function*(){const t={id:this.Rt,address:this.Pt,aName:this.Nt,sheetscope:this.Ot},e={action:bt,params:t},i=yield this.t.i(e);return d.u.h(this,i),!this.o}))}focus(){return a(this,void 0,void 0,(function*(){const t={action:Ct,params:{id:this.Rt,sheetName:this.St}},e=yield this.t.i(t);d.u.h(this,e)}))}setData(t){return a(this,void 0,void 0,(function*(){if("object"!=typeof t)return!1;const e={action:It,params:{id:this.Rt,sheetName:this.St,params:t}},i=yield this.t.i(e);return d.u.h(this,i),!(this.o||!i.detail)}))}getId(){return this.Rt}getNameData(){return a(this,void 0,void 0,(function*(){const t={action:xt,params:{index:this.Rt,sheetName:this.St}},e=yield this.t.i(t);return d.u.h(this,e),e}))}}e.Name=qt;class Kt{constructor(t){this.t=t}Ft(t,e,i,s,o){return a(this,void 0,void 0,(function*(){let r=null;const h=!o;if(e)if(h){r={sheetName:e.name,startRow:1,startCol:1,endRow:Number(n.Constant.MaxRowCount),endCol:Number(n.Constant.MaxColCount)}}else{r={sheetName:e.getSheet().name,startRow:e.row,startCol:e.column,endRow:e.endRow,endCol:e.endColumn}}const a={action:Nt,params:{type:t,users:i,description:s,bSheet:h,sheetName:o,range:r}},c=yield this.t.i(a);return d.u.h(this,c),!this.o&&c.detail?c.detail:null}))}Et(t,e,i){return a(this,void 0,void 0,(function*(){if(!t)return null;const s={action:Rt,params:{index:t,sheetName:e,bSheet:i}},n=yield this.t.i(s);return d.u.h(this,n),!this.o&&n.detail?n.detail:null}))}At(t,e){return a(this,void 0,void 0,(function*(){const i={action:kt,params:{sheetName:t,bSheet:e}},s=yield this.t.i(i);let n=0;return d.u.h(this,s),this.o||(n=s.detail),n}))}Dt(t,e){return a(this,void 0,void 0,(function*(){const i={action:Pt,params:{sheetName:t,bSheet:e}},s=yield this.t.i(i);return d.u.h(this,s),!(this.o||!s.detail)}))}jt(){return this.t}}e.Permissions=Kt;class Yt{constructor(t,e){this.t=t,this.Rt=e}addUsers(t){return a(this,void 0,void 0,(function*(){const e={users:t,action:n.PermissionUpdateType.Add,id:this.Rt};return yield this.Mt(e)}))}removeUsers(t){return a(this,void 0,void 0,(function*(){const e={users:t,action:n.PermissionUpdateType.Remove,id:this.Rt};return yield this.Mt(e)}))}removeAllUsers(){return a(this,void 0,void 0,(function*(){const t={users:[],action:n.PermissionUpdateType.Clear,id:this.Rt};return yield this.Mt(t)}))}Mt(t){return a(this,void 0,void 0,(function*(){const e={action:Ot,params:t},i=yield this.t.i(e);return d.u.h(this,i),!(this.o||!i.detail)}))}Ht(t,e){return a(this,void 0,void 0,(function*(){const i={sheetName:t,bSheet:e,id:this.Rt},s={action:Pt,params:i},n=yield this.t.i(s);return d.u.h(this,n),!(this.o||!n.detail)}))}Bt(t){return a(this,void 0,void 0,(function*(){const e={action:Ft,params:{id:t}},i=yield this.t.i(e);return d.u.h(this,i),!this.o&&i.detail?i.detail:null}))}getID(){return this.Rt}jt(){return this.t}}e.Permission=Yt;class Xt extends Kt{constructor(t){super(t.getApp()),this.it=t,Object.defineProperties(this,{count:{get(){return a(this,void 0,void 0,(function*(){const t=this.it.name;return yield this.At(t,!1)}))}}})}add(t,e,i,s){return a(this,void 0,void 0,(function*(){const n=yield this.Ft(t,e,i,s,this.it.name);if(n)return new Zt(this,n)}))}item(t){return a(this,void 0,void 0,(function*(){const e=this.it.name,i=yield this.Et(t,e,!1);if(i)return new Zt(this,i)}))}deleteAll(){return a(this,void 0,void 0,(function*(){const t=this.it.name;return yield this.Dt(t,!1)}))}Gt(){return this.it}}e.RangePermissions=Xt;class Zt extends Yt{constructor(t,e){super(t.jt(),e),this.parent=t,Object.defineProperties(this,{range:{get(){return a(this,void 0,void 0,(function*(){const i=yield this.Bt(e),s=t.Gt(),{startRow:n,startCol:o,endRow:r,endCol:h}=i;return s.getRange(n,o,r,h)}))}}})}delete(){return a(this,void 0,void 0,(function*(){const t=this.parent.Gt().name;return yield this.Ht(t,!1)}))}}e.RangePermission=Zt;class Qt extends Kt{constructor(t){super(t.t),this.parent=t,Object.defineProperties(this,{count:{get(){return a(this,void 0,void 0,(function*(){return yield this.At(null,!0)}))}}})}add(t,e,i,s){return a(this,void 0,void 0,(function*(){const n=yield this.Ft(t,e,i,s,null);if(n)return new te(this,n)}))}item(t){return a(this,void 0,void 0,(function*(){const e=yield this.Et(t,null,!0);if(e)return new te(this,e)}))}deleteAll(){return a(this,void 0,void 0,(function*(){return yield this.Dt(null,!0)}))}Lt(){return this.parent}}e.SheetPermissions=Qt;class te extends Yt{constructor(t,e){super(t.jt(),e),Object.defineProperties(this,{sheet:{get(){return a(this,void 0,void 0,(function*(){const i=yield this.Bt(e),{sheetName:s}=i,n=t.Lt();return yield n.getSheetByName(s)}))}}})}delete(){return a(this,void 0,void 0,(function*(){return yield this.Ht(null,!0)}))}}e.SheetPermission=te;class ee{constructor(t,e,i=!0){this.t=t,this.range=e,this.bSheet=i,Object.defineProperties(this,{count:{get(){return a(this,void 0,void 0,(function*(){const t=this.generateParams(),e={action:Et,params:t},i=yield this.t.i(e);let s=0;return d.u.h(this,i),this.o||(s=i.detail),s}))}}})}item(t){return a(this,void 0,void 0,(function*(){const e=this.generateParams(),i={action:At,params:Object.assign(Object.assign({},e),{index:t})},s=yield this.t.i(i);if(d.u.h(this,s),!this.o){const{id:t,usage:e}=s.detail;return new ie(this.t,t,e,this)}}))}getsheetName(){return this.range.getSheet().name}generateParams(){return{bSheet:this.bSheet,sheetName:this.getsheetName(),row:this.range.row,column:this.range.column,endRow:this.range.endRow,endColumn:this.range.endColumn}}}e.Shapes=ee;class ie{constructor(t,e,i,s){this.t=t,this.id=e,this.usage=i,this.parent=s}getImageDataURL(){return a(this,void 0,void 0,(function*(){const t={id:this.id,usage:this.usage,sheetName:this.parent.getsheetName()},e={action:Dt,params:t},i=yield this.t.i(e);return d.u.h(this,i),this.o?null:i.detail}))}}e.Shape=ie;class se extends t.ContentFrames{constructor(t){super(t),this.t=t}add(e,i,s){return a(this,void 0,void 0,(function*(){if(!e)throw new Error(`invalid size: ${e}`);if(!e.height||"number"!=typeof e.height)throw new Error(`invalid height: ${e.height}, please input a valid number`);if(e.width&&"number"!=typeof e.width||0===e.width)throw new Error(`invalid width: ${e.width}, please input a valid number`);const n={action:t.ApiOperation.IDocsContentFramesAdd,params:[{size:e,src:i,bUpdateCellSize:s}]},o=yield this.t.i(n);return d.u.h(this,o),!this.o&&o.detail?new ne(this.t,o.detail):void 0}))}}class ne extends t.ContentFrame{constructor(t,e){super(t,e)}}e.ContentFrame=ne;class oe{constructor(t,e){this.it=t,this.range=e}setRule(t){return a(this,void 0,void 0,(function*(){const e={col:this.range.column-1,row:this.range.row-1,endCol:this.range.endColumn-1,endRow:this.range.endRow-1},i={action:Mt,params:{rule:t,sheetName:this.it.name,rangeInfo:e}},s=yield this.it.t.i(i);return d.u.h(this,s),!this.o}))}clear(){return a(this,void 0,void 0,(function*(){const t={col:this.range.column-1,row:this.range.row-1,endCol:this.range.endColumn-1,endRow:this.range.endRow-1},e={action:Ht,params:{rangeInfo:t,sheetName:this.it.name}},i=yield this.it.t.i(e);return d.u.h(this,i),!this.o}))}}e.DataValidation=oe}(o||(o={})),function(t){let e,i,s,n,o,r,h,a,c,d,u,l,m,v,f,p,_,g,w,y,x;!function(t){t[t.NoProtection=0]="NoProtection",t[t.FormEntry=1]="FormEntry",t[t.Revision=2]="Revision",t[t.EditArea=4]="EditArea",t[t.Comments=8]="Comments",t[t.Forms=16]="Forms",t[t.Readonly=32]="Readonly"}(e=t.ProtectionType||(t.ProtectionType={})),function(t){t[t.wdReplaceAll=2]="wdReplaceAll",t[t.wdReplaceNone=0]="wdReplaceNone",t[t.wdReplaceOne=1]="wdReplaceOne"}(i=t.WdReplace||(t.WdReplace={})),function(t){t[t.wdUnderlineNone=0]="wdUnderlineNone",t[t.wdUnderlineSingle=1]="wdUnderlineSingle"}(s=t.WdUnderline||(t.WdUnderline={})),function(t){t[t.MaxImportImageSize=10485760]="MaxImportImageSize"}(n=t.Constant||(t.Constant={})),function(t){t[t.wdByAuthor=-1]="wdByAuthor",t[t.wdAuto=0]="wdAuto",t[t.wdBlack=1]="wdBlack",t[t.wdBlue=2]="wdBlue",t[t.wdTurquoise=3]="wdTurquoise",t[t.wdBrightGreen=4]="wdBrightGreen",t[t.wdPink=5]="wdPink",t[t.wdRed=6]="wdRed",t[t.wdYellow=7]="wdYellow",t[t.wdWhite=8]="wdWhite",t[t.wdDarkBlue=9]="wdDarkBlue",t[t.wdTeal=10]="wdTeal",t[t.wdGreen=11]="wdGreen",t[t.wdViolet=12]="wdViolet",t[t.wdDarkRed=13]="wdDarkRed",t[t.wdDarkYellow=14]="wdDarkYellow",t[t.wdGray50=15]="wdGray50",t[t.wdGray25=16]="wdGray25",t[t.wdOrigin=17]="wdOrigin",t[t.wdGreenLight=18]="wdGreenLight"}(o=t.WdColorIndex||(t.WdColorIndex={})),function(t){t[t.CONTAINERELEMENT=1]="CONTAINERELEMENT",t[t.BODY=2]="BODY",t[t.PARAGRAPH=4]="PARAGRAPH",t[t.TEXT=8]="TEXT",t[t.BOOKMARK=16]="BOOKMARK",t[t.PERMMARK=32]="PERMMARK",t[t.TABLE=64]="TABLE",t[t.ROW=128]="ROW",t[t.COLUMN=256]="COLUMN",t[t.CELL=512]="CELL",t[t.SHAPE=1024]="SHAPE",t[t.INLINESHAPE=2048]="INLINESHAPE",t[t.SECTION=4096]="SECTION",t[t.HEADERFOOTER=8192]="HEADERFOOTER",t[t.UNSUPPORTED=16384]="UNSUPPORTED",t[t.Hyperlink=32768]="Hyperlink",t[t.COMMENT=65536]="COMMENT",t[t.CONTENTFRAME=131072]="CONTENTFRAME"}(r=t.ElementType||(t.ElementType={})),function(t){t.PARAGRAPH="paragraph",t.SENTENCE="sentence"}(h=t.ScopeType||(t.ScopeType={})),function(t){t.SELF="self",t.NEXTSIBLING="nextSibling"}(a=t.DirectionType||(t.DirectionType={})),function(t){t.Insert="ins",t.Delete="del",t.ParagraphProperty="pPrChange"}(c=t.RevisionType||(t.RevisionType={})),function(t){t[t.Paragraph=1]="Paragraph",t[t.Bookmark=2]="Bookmark",t[t.PermMark=3]="PermMark",t[t.Row=4]="Row",t[t.HeaderFooter=5]="HeaderFooter"}(d=t.PositionType||(t.PositionType={})),function(t){t.before="before",t.containsStart="containsStart",t.equal="equal",t.outside="outside",t.containsEnd="containsEnd",t.inside="inside",t.behind="behind"}(u=t.LocationRelation||(t.LocationRelation={})),function(t){t.BOOKMARK="book",t.PERMMARK="perm"}(l=t.MarkType||(t.MarkType={})),function(t){t[t.wdWrapNone=3]="wdWrapNone",t[t.wdWrapFront=3]="wdWrapFront",t[t.wdWrapBehind=5]="wdWrapBehind",t[t.wdWrapInline=7]="wdWrapInline"}(m=t.WdWrapType||(t.WdWrapType={})),function(t){t[t.wdRevisionsViewFinal=0]="wdRevisionsViewFinal",t[t.wdRevisionsViewOriginal=1]="wdRevisionsViewOriginal"}(v=t.WdRevisionsView||(t.WdRevisionsView={})),function(t){t[t.wdStyleNormal=-1]="wdStyleNormal",t[t.wdStyleHeading1=-2]="wdStyleHeading1",t[t.wdStyleHeading2=-3]="wdStyleHeading2",t[t.wdStyleHeading3=-4]="wdStyleHeading3",t[t.wdStyleHeading4=-5]="wdStyleHeading4",t[t.wdStyleHeading5=-6]="wdStyleHeading5",t[t.wdStyleHeading6=-7]="wdStyleHeading6",t[t.wdStyleHeading7=-8]="wdStyleHeading7",t[t.wdStyleHeading8=-9]="wdStyleHeading8",t[t.wdStyleHeading9=-10]="wdStyleHeading9",t[t.wdStyleTitle=-63]="wdStyleTitle",t[t.wdStyleSubtitle=-75]="wdStyleSubtitle"}(f=t.WdBuiltinStyle||(t.WdBuiltinStyle={})),function(t){t[t.wdOutlineLevel1=1]="wdOutlineLevel1",t[t.wdOutlineLevel2=2]="wdOutlineLevel2",t[t.wdOutlineLevel3=3]="wdOutlineLevel3",t[t.wdOutlineLevel4=4]="wdOutlineLevel4",t[t.wdOutlineLevel5=5]="wdOutlineLevel5",t[t.wdOutlineLevel6=6]="wdOutlineLevel6",t[t.wdOutlineLevel7=7]="wdOutlineLevel7",t[t.wdOutlineLevel8=8]="wdOutlineLevel8",t[t.wdOutlineLevel9=9]="wdOutlineLevel9",t[t.wdOutlineLevelBodyText=10]="wdOutlineLevelBodyText"}(p=t.WdOutlineLevel||(t.WdOutlineLevel={})),function(t){t[t.wdHeaderFooterPrimary=1]="wdHeaderFooterPrimary",t[t.wdHeaderFooterFirstPage=2]="wdHeaderFooterFirstPage",t[t.wdHeaderFooterEvenPages=3]="wdHeaderFooterEvenPages"}(_=t.WdHeaderFooterIndex||(t.WdHeaderFooterIndex={})),function(t){t.ReadOnly="readOnly",t.Editable="editable",t.None="none"}(g=t.DocPermission||(t.DocPermission={})),function(t){t.ReadOnly="readOnly",t.Editable="editable",t.Hidden="hidden"}(w=t.PermissionType||(t.PermissionType={})),function(t){t.TEXT="text",t.EMPTY="empty"}(y=t.MarksIdentifyRule||(t.MarksIdentifyRule={})),function(t){t.ABOVE="above",t.BEFORE="before"}(x=t.MarksGenerateNameRule||(t.MarksGenerateNameRule={}))}(r||(r={})),function(e){const i=new Set(["IDOCS.EVENT.selectionChange","IDocs.Event.ContentChange","IDOCS.EVENT.clipboardChanged","IDOCS.EVENT.internalClipPasted","Word.Event.PermMarkAction"]),s={[r.MarksIdentifyRule.TEXT]:"underline",[r.MarksIdentifyRule.EMPTY]:"recspaces"},n={[r.MarksGenerateNameRule.ABOVE]:"byUnderlineText",[r.MarksGenerateNameRule.BEFORE]:"beforeColon"},o={"#000000":r.WdColorIndex.wdBlack,"#ffffff":r.WdColorIndex.wdWhite,"#FD4147":r.WdColorIndex.wdRed,"#FF8700":r.WdColorIndex.wdOrigin,"#FDC82F":r.WdColorIndex.wdYellow,"#00D09B":r.WdColorIndex.wdGreen,"#00D0D9":r.WdColorIndex.wdGreenLight,"#4696FB":r.WdColorIndex.wdBlue,"#A981FF":r.WdColorIndex.wdViolet,"#00FF00":r.WdColorIndex.wdBrightGreen,"#000080":r.WdColorIndex.wdDarkBlue,"#800000":r.WdColorIndex.wdDarkRed,"#808000":r.WdColorIndex.wdDarkYellow,"#C0C0C0":r.WdColorIndex.wdGray25,"#808080":r.WdColorIndex.wdGray50,"#FF00FF":r.WdColorIndex.wdPink,"#008080":r.WdColorIndex.wdTeal,"#00FFFF":r.WdColorIndex.wdTurquoise},h=[r.ProtectionType.FormEntry,r.ProtectionType.Revision,r.ProtectionType.EditArea,r.ProtectionType.Comments,r.ProtectionType.Forms,r.ProtectionType.Readonly];e.ApiOperation={TextElementGetNextSibling:"_text_element_getNextSibling",TextElementGetNodePath:"_text_element_getNodePath",TextElementGetParent:"_text_element_getParent",TextElementGetPrevSibling:"_text_element_getPrevSibling",TextElementViewGetPageInfo:"_text_element_view_getPageInfo",TextElementGetRange:"_text_element_getRange",TextContainerElementGetChild:"_text_containerElement_getChild",TextContainerElementGetChildIndex:"_text_containerElement_getChildIndex",TextContainerElementGetNumChildren:"_text_containerElement_getNumChildren",TextContainerElementInsectObject:"_text_containerElement_insectObject",TextGetWordsCount:"_text_getWordCount",TextAppSetUIState:"_text_app_setUIState",TextMarkGetText:"_text_mark_getText",TextMarkSetText:"_text_mark_setText",TextMarkFocus:"_text_mark_focus",TextBookmarksItem:"_text_bookmarks_item",TextBookmarksAdd:"_text_bookmarks_add",TextBookmarksSetTextCandidates:"_text_bookmarks_setTextCandidates",TextBookmakrsIntelligentGeneration:"_text_bookmakrs_intelligentGeneration",TextBookmarksSetColor:"_text_bookmarks_setColor",TextBookmarkDelete:"_text_bookmark_delete",TextBookmarkGetContent:"_text_bookmark_getContent",TextBookmarkSetContent:"_text_bookmark_setContent",TextBookmarkGetHtml:"_text_bookmark_getHtml",TextBookmarkSetHtml:"_text_bookmark_setHtml",TextBookmarkSetText:"_text_bookmark_setText",TextPermMarksItem:"_text_permMarks_item",TextPermMarksAdd:"_text_permMarks_add",TextPermMarkGetAuthUsers:"_text_permMark_getAuthUsers",TextPermMarkAddUser:"_text_permMark_addUser",TextPermMarkDeleteUser:"_text_permMark_deleteUser",TextPermMarkSetUser:"_text_permMark_setUser",TextPermMarkDelete:"_text_permMark_delete",TextPermMarkPermissionType:"_text_permMark_permissionType",TextParagraphsAll:"_text_paragraphs_all",TextParagraphsItem:"_text_paragraphs_item",TextParagraphsCount:"_text_paragraphs_count",TextParagraphsAdd:"_text_paragraphs_add",TextParagraphAppendText:"_text_paragraph_appendText",TextParagraphSetText:"_text_paragraph_setText",TextParagraphGetLength:"_text_paragraph_getLength",TextParagraphGetText:"_text_paragraph_getText",TextParagraphOutlineLevel:"_text_paragraph_outlineLevel",TextParagraphGetIndex:"_text_paragraph_getIndex",TextTablesItem:"_text_tables_item",TextTablesCount:"_text_tables_count",TextTablesAdd:"_text_tables_add",TextTableTitle:"_text_table_title",TextTableSetTitle:"_text_table_setTitle",TextTableDelete:"_text_table_delete",TextColumnsCount:"_text_columns_count",TextColumnsAdd:"_text_columns_add",TextColumnsItem:"_text_columns_item",TextColumnsDeleteColumns:"_text_columns_deleteColumns",TextColumnIndex:"_text_column_index",TextColumnDelete:"_text_column_delete",TextRowsCount:"_text_rows_count",TextRowsAdd:"_text_rows_add",TextRowsItem:"_text_rows_item",TextRowsDeleteRows:"_text_rows_deleteRows",TextRowIndex:"_text_row_index",TextRowDelete:"_text_row_delete",TextCellsCount:"_text_cells_count",TextCellsItem:"_text_cells_item",TextCellGetRowSpan:"_text_cell_getRowSpan",TextCellGetColSpan:"_text_cell_getColSpan",TextCellGetIndex:"_text_cell_getIndex",TextCellGetHtml:"_text_cell_getHtml",TextCellSetHtml:"_text_cell_setHtml",TextCellGetText:"_text_cell_getText",TextCellSetText:"_text_cell_setText",TextGetRevisionsMode:"_text_revisions_getMode",TextSetRevisionsMode:"_text_revisions_setMode",TextRevisionsCount:"_text_revisions_count",TextRevisionsItem:"_text_revisions_item",TextRevisionsAcceptAll:"_text_revisions_acceptAll",TextRevisionsRejectAll:"_text_revisions_rejectAll",TextRevisionsGetAll:"_text_revisions_getAll",TextRevisionRange:"_text_revision_range",TextRevisionAccept:"_text_revision_accept",TextRevisionReject:"_text_revision_reject",TextRangeSetText:"_text_range_setText",TextRangeCompare:"_text_range_compare",TextRangeInsertText:"_text_range_insertText",TextRangeGetText:"_text_range_getText",TextRangeSetFontStyle:"_text_range_setFontStyle",TextRangeGetFontStyle:"_text_range_getFontStyle",TextRangeGetCollection:"_text_range_getCollection",TextRangeGetHtml:"_text_range_getHtml",TextRangeSetHtml:"_text_range_setHtml",TextRangeScrollIntoView:"_text_range_scrollIntoView",TextWebClipboardCopy:"_text_WebClipboard_Copy",TextWebClipboardPaste:"_text_WebClipboard_Paste",TextPicturesAdd:"_text_pictures_add",TextPictureDelete:"_text_picture_delete",TextPictureFocus:"_text_picture_focus",TextShapesItem:"_text_shapes_item",TextShapesCount:"_text_shapes_count",TextShapeName:"_text_shape_name",TextShapeSetName:"_text_shape_setName",TextInlineShapesItem:"_text_inlineShapes_item",TextInlineShapesCount:"_text_inlineShapes_count",TextFindHitHighlight:"_text_find_hitHighlight",TextFindClearHighlight:"_text_find_clearHighlight",TextFindExecute:"_text_find_execute",TextFindData:"_text_find_data",TextGetHeadingLevel:"_text_style_getHeadingLevel",TextSetHeadingLevel:"_text_style_setHeadingLevel",TextSectionsCount:"_text_sections_count",TextSectionsItem:"_text_sections_item",TextHeadersItem:"_text_headers_item",TextFootersItem:"_text_footers_item",TextOutlineEntriesCount:"_text_outlineEntries_count",TextOutlineEntriesItem:"_text_outlineEntries_item",TextOutlineEntryRange:"_text_outlineEntry_range",TextOutlineEntryFocus:"_text_outlineEntry_focus",TextOutlineEntryLevel:"_text_outlineEntry_getLevel",TextOutlineEntryGetText:"_text_outlineEntry_getText",TextBodyGetContent:"_text_body_getContent",TextBodySetContent:"_text_body_setContent",TextBodyGetHtml:"_text_body_getHtml",TextBodySetHtml:"_text_body_setHtml",TextCopyToInternal:"_text_copyToInternal",TextSelectBookmarkTextInScope:"_text_selectBookmarkTextInScope",TextPasteFromInternal:"_text_pasteFromInternal",TextCleanDocument:"_text_cleanDocument",TextCleanComments:"_text_cleanComments",TextSetTrackChange:"_text_setTrackChange",TextGetPageCount:"_text_getPageCount",TextGetSelection:"_text_getSelection",TextSetSelection:"_text_setSelection",TextGetDocProperty:"_text_getDocProperty",TextClearChangeHistory:"_text_clearChangeHistory",TextContentFormatted:"_text_contentFormatted",TextOutlineLevelGetRange:"_text_outlineLevel_getRange",TextSwitchDataProtectionMode:"_text_switchDataProtectionMode",IDocsIsDataProtectionOn:"_idocs_getDataProtectionStatus",TextProtectionType:"_text_ProtectionType",TextDefaultEditAuthType:"_text_defaultEditAuthType",TextSelectionGetPosition:"_text_selectionGetPosition",TextGetRevisionsView:"_text_getRevisionsView",TextSetRevisionsView:"_text_setRevisionsView",TextGetCommentsStatus:"_text_getcommentsStatus",TextSetCommentsStatus:"_text_setcommentsStatus",TextGetRevisionAndCommentsStatus:"_text_getRevisionAndCommentsStatus",TextSetRevisionAndCommentsStatus:"_text_setRevisionAndCommentsStatus",TextOaextMoveFootArea:"_text_oaext_moveFootArea",TextOaextGetShapePosition:"_text_oaext_getShapePosition",HyperlinksAdd:"_text_hyperlinks_add",jumpToMark:"_text_jumpToMark",TextCommentsItem:"_text_comments_item",TextCommentsAdd:"_text_comments_add",TextCommentGetParent:"_text_comment_getParent",TextCommentGetRange:"_text_comment_getRange",TextCommentDetail:"_text_comment_Detail",TextCommentResolve:"_text_comment_resolve",TextCommentDelete:"_text_comment_delete",TextCommentFocus:"_text_comment_focus",TextCommentSetHidden:"_text_comment_setHidden",TextCommentSetColor:"_text_comment_setColor"};class c{constructor(t,e,i){if(this.isContainerEle=!1,!e||!t)throw"invalid argument";this.t=t,this.type=i,this.id=e,this.o=null}getId(){return this.id}getAttributes(){return a(this,void 0,void 0,(function*(){}))}getNextSibling(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextElementGetNextSibling,params:[this.toJson()]},i=yield this.t.i(t);let s;return d.u.h(this,i),!this.o&&i.detail&&(s=this.t.ActiveDocument.getElement(i.detail.type,{id:i.detail.id,detail:i.detail})),s}))}getNodePath(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextElementGetNodePath,params:[this.toJson()]},i=yield this.t.i(t);let s;return d.u.h(this,i),!this.o&&i.detail&&(s=i.detail),s}))}getParent(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextElementGetParent,params:[this.toJson()]},i=yield this.t.i(t);let s;return d.u.h(this,i),!this.o&&i.detail&&(s=this.t.ActiveDocument.getElement(i.detail.type,{id:i.detail.id,detail:i.detail})),s}))}getPrevSibling(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextElementGetPrevSibling,params:[this.toJson()]},i=yield this.t.i(t);let s;return d.u.h(this,i),!this.o&&i.detail&&(s=this.t.ActiveDocument.getElement(i.detail.type,{id:i.detail.id,detail:i.detail})),s}))}getLayoutPageInfo(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextElementViewGetPageInfo,params:[this.toJson()]},i=yield this.t.i(t);let s;return d.u.h(this,i),!this.o&&i.detail&&(s=i.detail),s}))}setAttributes(t){t&&Array.isArray(t)||(this.o="invalid argument")}toJson(){const t={};switch(t.id=this.id,this.type){case r.ElementType.BODY:t.type="body";break;case r.ElementType.PARAGRAPH:t.type="paragraph";break;case r.ElementType.TEXT:t.type="text";break;case r.ElementType.BOOKMARK:t.type="bookmark";break;case r.ElementType.PERMMARK:t.type="permMark";break;case r.ElementType.TABLE:t.type="table";break;case r.ElementType.ROW:t.type="row";break;case r.ElementType.COLUMN:t.type="column";break;case r.ElementType.CELL:t.type="cell";break;default:t.type=this.type}return t}isContainer(){return this.isContainerEle}getPageNum(){return 1}getPage(){}}class l extends c{constructor(t,e,i=r.ElementType.CONTAINERELEMENT){super(t,e,i),this.isContainerEle=!0}findElement(t,e){return a(this,void 0,void 0,(function*(){let t=e;void 0===e&&(t=1)}))}getChild(t){return a(this,void 0,void 0,(function*(){if(t<=0)return void(this.o="invalid argument");const i={action:e.ApiOperation.TextContainerElementGetChild,params:[this.toJson(),t]},s=yield this.t.i(i);let n;return d.u.h(this,s),!this.o&&s.detail&&(n=this.t.ActiveDocument.getElement(s.detail.type,{id:s.detail.id,detail:s.detail})),n}))}getChildIndex(t){return a(this,void 0,void 0,(function*(){if(!t)return void(this.o="invalid argument");const i={action:e.ApiOperation.TextContainerElementGetChildIndex,params:[this.toJson(),t.toJson()]},s=yield this.t.i(i);d.u.h(this,s);let n=-1;return!this.o&&s.detail>0&&(n=s.detail),n}))}getChildCount(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextContainerElementGetNumChildren,params:[this.toJson()]},i=yield this.t.i(t);d.u.h(this,i);let s=0;return!this.o&&i.detail>=0&&(s=i.detail),s}))}getTextAlignment(){return a(this,void 0,void 0,(function*(){}))}setTextAlignment(t){}toJson(){const t={};switch(t.id=this.id,this.type){case r.ElementType.BODY:t.type="body";break;case r.ElementType.PARAGRAPH:t.type="paragraph";break;case r.ElementType.TEXT:t.type="text";break;case r.ElementType.SECTION:t.type="section";break;case r.ElementType.HEADERFOOTER:t.type="headerFooter";break;default:t.type=this.type}return t.isContainer=!0,t}}class m{constructor(t,i,s){if(!t)throw"invalid argument";this.t=t,this.Wt=s&&!s.isAllDocument()?s.toJson():void 0,this.Vt=i,Object.defineProperties(this,{count:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextRangeGetCollection,params:["comment",this.Wt,this.Vt&&{cmtId:this.Vt}]},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail.length),s}))}}})}toJson(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextRangeGetCollection,params:["comment",this.Wt,{toJson:!0,cmtId:this.Vt}]},i=yield this.t.i(t);return d.u.h(this,i),this.o?null:i.detail}))}add(t,i){return a(this,void 0,void 0,(function*(){const s={action:e.ApiOperation.TextCommentsAdd,params:[t,null==i?void 0:i.toJson(),this.Vt]},n=yield this.t.i(s,!0);let o;return d.u.h(this,n),this.o||(o=new v(this.t,n.detail)),o}))}item(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.TextCommentsItem,params:[t,this.Wt,this.Vt]},s=yield this.t.i(i);let n;return d.u.h(this,s),!this.o&&s.detail&&(n=new v(this.t,s.detail)),n}))}}class v extends c{constructor(t,i){super(t,i,r.ElementType.COMMENT),Object.defineProperties(this,{range:{get(){return a(this,void 0,void 0,(function*(){let t;const i={action:e.ApiOperation.TextCommentGetRange,params:[this.id]},s=yield this.t.i(i);if(d.u.h(this,s),!this.o&&s.detail){const{start:e,end:i}=s.detail;t=new j(this.t);const n=new P(this.t,e.id),o=new M(this.t,n,e.offset,r.PositionType.Paragraph),h=new P(this.t,i.id),a=new M(this.t,h,i.offset,r.PositionType.Paragraph);return new j(this.t,o,a)}console.error("Can not find the element!")}))}},content:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextCommentDetail,params:[this.id]},i=yield this.t.i(t);return d.u.h(this,i),!this.o&&i.detail?i.detail.content:null}))}},done:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextCommentDetail,params:[this.id]},i=yield this.t.i(t);return d.u.h(this,i),!this.o&&i.detail?i.detail.done:null}))},set(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.TextCommentResolve,params:{id:this.id,resolved:t}},s=yield this.t.i(i,!0);return d.u.h(this,s),!this.o&&s.detail?s.detail:null}))}},creator:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextCommentDetail,params:[this.id]},i=yield this.t.i(t);if(d.u.h(this,i),!this.o&&i.detail)return i.detail.creator}))}},time:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextCommentDetail,params:[this.id]},i=yield this.t.i(t);if(d.u.h(this,i),!this.o&&i.detail)return i.detail.time}))}},parent:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextCommentGetParent,params:[this.id]},i=yield this.t.i(t);if(d.u.h(this,i),!this.o&&i.detail)return new v(this.t,i.detail)}))}},Replies:{get(){return a(this,void 0,void 0,(function*(){if(!this._replies){if(yield this.parent)return;this._replies=new m(t,this.id)}return this._replies}))}}})}delete(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextCommentDelete,params:{id:this.id}},i=yield this.t.i(t,!0);if(d.u.h(this,i),!this.o)return i.detail}))}toJson(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextCommentDetail,params:[this.id]},i=yield this.t.i(t);if(d.u.h(this,i),!this.o)return i.detail}))}focus(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextCommentFocus,params:{commentId:this.id}},i=yield this.t.i(t);d.u.h(this,i)}))}setHidden(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.TextCommentSetHidden,params:[this.id,t]},s=yield this.t.i(i);if(d.u.h(this,s),!this.o)return s.detail}))}setHighlightColor(t){return a(this,void 0,void 0,(function*(){if(!/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(t))throw new Error("Please enter a legal hexadecimal color code, e.g. #e6e6e6");const i={action:e.ApiOperation.TextCommentSetColor,params:[this.id,t]},s=yield this.t.i(i);if(d.u.h(this,s),!this.o)return s.detail}))}}class f{constructor(t,e){if(!t)throw"invalid argument";this.t=t,this.Wt=e&&!e.isAllDocument()?e.toJson():void 0,Object.defineProperties(this,{Bold:{get(){return a(this,void 0,void 0,(function*(){const t=yield this.getFontStyle(D.Bold);if(!this.o&&(t.detail||!1===t.detail))return t.detail}))},set(t){if("boolean"!=typeof t)throw new Error("Invalid value for Bold. Expected a boolean.");this.setFontStyle(D.Bold,t)}},Underline:{get(){return a(this,void 0,void 0,(function*(){const t=yield this.getFontStyle(D.Underline);if(!this.o&&(t.detail||0===t.detail))return t.detail}))},set(t){if(0!==t&&1!==t)throw new Error("Invalid value for Underline. Expected 0 or 1.");this.setFontStyle(D.Underline,t)}},Italic:{get(){return a(this,void 0,void 0,(function*(){const t=yield this.getFontStyle(D.Italic);if(!this.o&&(t.detail||!1===t.detail))return t.detail}))},set(t){if("boolean"!=typeof t)throw new Error("Invalid value for Italic. Expected a boolean.");this.setFontStyle(D.Italic,t)}},ColorIndex:{get(){return a(this,void 0,void 0,(function*(){const t=yield this.getFontStyle(D.Color);if(!this.o&&t.detail)return o[t.detail]||r.WdColorIndex.wdByAuthor}))},set(t){if(!Object.values(r.WdColorIndex).includes(t))throw new Error(`Invalid value for WdColorIndex: ${t}`);if(t===r.WdColorIndex.wdByAuthor)return;let e;if(t===r.WdColorIndex.wdAuto)e="#000000";else for(const i in o){if(o[i]===t){e=i;break}}this.setFontStyle(D.ColorIndex,e)}},Color:{get(){return a(this,void 0,void 0,(function*(){const t=yield this.getFontStyle(D.Color);if(!this.o&&t.detail)return t.detail}))},set(t){if(!/^#[0-9A-Fa-f]{6}$/.test(t))throw new Error("Invalid value for Color. Expected a hex.");this.setFontStyle(D.ColorIndex,t)}},Size:{get(){return a(this,void 0,void 0,(function*(){const t=yield this.getFontStyle(D.Size);if(!this.o&&t.detail)return Number(t.detail.replace("pt",""))}))},set(t){if(!(t<=1638&&t>=1))throw new Error(`Invalid key for FontSize: ${t}. Expected [1,1638]`);this.setFontStyle(D.Size,t)}}})}getFontStyle(t){return a(this,void 0,void 0,(function*(){if(!Object.values(D).includes(t))throw"invalid font style!";const i={action:e.ApiOperation.TextRangeGetFontStyle,params:[this.Wt,t]},s=yield this.t.i(i);return d.u.h(this,s),s}))}setFontStyle(t,i){return a(this,void 0,void 0,(function*(){if(!Object.values(D).includes(t))throw"invalid font style!";const s={action:e.ApiOperation.TextRangeSetFontStyle,params:[this.Wt,t,i]},n=yield this.t.i(s);let o;return d.u.h(this,n),this.o||(o="success"===n.status),o}))}}class p{constructor(t,i){if(!t)throw"invalid argument";this.t=t,this.Wt=i&&!i.isAllDocument()?i.toJson():void 0,Object.defineProperties(this,{count:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextRangeGetCollection,params:["bookmark",this.Wt]},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail.length),s}))}}})}toJson(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextRangeGetCollection,params:["bookmark",this.Wt]},i=yield this.t.i(t);let s;if(d.u.h(this,i),!this.o){s=[];const t=i.detail;for(let e=0;e<t.length;e+=1)s.push(t[e].name)}return s}))}add(t,i){return a(this,void 0,void 0,(function*(){const s={action:e.ApiOperation.TextBookmarksAdd,params:[t,null==i?void 0:i.toJson()]},n=yield this.t.i(s,!0);let o;return d.u.h(this,n),this.o||(o=new _(this.t,n.detail)),o}))}item(t){return a(this,void 0,void 0,(function*(){const i=u.handleItemKey(t,!0);if(void 0===i)return;const s={action:e.ApiOperation.TextBookmarksItem,params:[i,this.Wt]},n=yield this.t.i(s);let o;return d.u.h(this,n),!this.o&&n.detail&&(o=new _(this.t,n.detail)),o}))}setTextCandidates(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.TextBookmarksSetTextCandidates,params:[JSON.stringify(t)]},s=yield this.t.i(i);let n;return d.u.h(this,s),this.o||(n=s.detail),n}))}identify(t,i,o){return a(this,void 0,void 0,(function*(){if(!Object.values(r.MarksIdentifyRule).includes(t))throw new Error(`Please provide valid identify rule: ${Object.values(r.MarksIdentifyRule)}`);if(!Object.values(r.MarksGenerateNameRule).includes(i))throw new Error(`Please provide valid name rule: ${Object.values(r.MarksGenerateNameRule)}`);if(t===r.MarksIdentifyRule.EMPTY&&i===r.MarksGenerateNameRule.ABOVE)throw new Error(`When identify rule is ${r.MarksIdentifyRule.EMPTY}, name rule can only be ${r.MarksGenerateNameRule.BEFORE}`);const h={type:"bookMark",nameRule:n[i],isRecSpaces:"recspaces"===s[t],includeHF:o||!1,bCreate:!0},a={action:e.ApiOperation.TextBookmakrsIntelligentGeneration,params:[h]},c=yield this.t.i(a);d.u.h(this,c);let u=!1;return this.o||(u=c.detail),u}))}setHighlightColor(t){return a(this,void 0,void 0,(function*(){if(!/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(t))throw new Error("Please enter a legal hexadecimal color code, e.g. #e6e6e6");const i={action:e.ApiOperation.TextBookmarksSetColor,params:[t]},s=yield this.t.i(i);if(d.u.h(this,s),!this.o)return s.detail}))}}class _ extends c{constructor(t,e){super(t,e,r.ElementType.BOOKMARK),Object.defineProperties(this,{name:{get(){return a(this,void 0,void 0,(function*(){const t=yield this._getBookmark();if(!this.o){if(t.detail)return t.detail;console.error("Can not find the element!")}}))}},range:{get(){return a(this,void 0,void 0,(function*(){const t=yield this._getBookmark();let e;if(!this.o){let i,s;if(t.detail)return e=new j(this.t),i=new M(this.t,this,0,r.PositionType.Bookmark),s=new M(this.t,this,1,r.PositionType.Bookmark),e.buildRange(i,s),e;console.error("Can not find the element!")}}))}}})}_getBookmark(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextBookmarksItem,params:[this.id]},i=yield this.t.i(t);return d.u.h(this,i),i}))}getHtml(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextBookmarkGetHtml,params:[this.id]},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))}setHtml(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.TextBookmarkSetHtml,params:[this.id,t]},s=yield this.t.i(i,!0);let n;return d.u.h(this,s),this.o||(n=s.detail),n}))}getText(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextMarkGetText,params:[this.id,r.MarkType.BOOKMARK]},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))}setText(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.TextMarkSetText,params:[this.id,t,r.MarkType.BOOKMARK]},s=yield this.t.i(i,!0);d.u.h(this,s);let n=!1;return this.o||(n=!0),n}))}getContent(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextBookmarkGetContent,params:[this.id]},i=yield this.t.i(t);let s;if(d.u.h(this,i),!this.o){const{result:t,version:e}=i.detail;s={version:e,data:t}}return s}))}setContent(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.TextBookmarkSetContent,params:[this.id,t]},s=yield this.t.i(i,!0);let n;return d.u.h(this,s),this.o||(n=s.detail),n}))}remove(){return a(this,void 0,void 0,(function*(){return this.t.Ut("Bookmark","remove","delete",!1),!1}))}delete(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextBookmarkDelete,params:[this.id]},i=yield this.t.i(t,!0);d.u.h(this,i);let s=!1;return this.o||(s=i.detail),s}))}focus(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextMarkFocus,params:[this.id,r.MarkType.BOOKMARK]},i=yield this.t.i(t);d.u.h(this,i);let s=!1;return this.o||(s=i.detail),s}))}setTextCandidates(t){return a(this,void 0,void 0,(function*(){let i={};i[yield this.name]=t;const s={action:e.ApiOperation.TextBookmarksSetTextCandidates,params:[JSON.stringify(i)]},n=yield this.t.i(s);let o;return d.u.h(this,n),this.o||(o=n.detail),o}))}}class g{constructor(t,i){if(!t)throw"invalid argument";this.t=t,this.Wt=i&&!i.isAllDocument()?i.toJson():void 0,Object.defineProperties(this,{count:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextRangeGetCollection,params:["permMark",this.Wt]},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail.length),s}))}}})}item(t){return a(this,void 0,void 0,(function*(){const i=u.handleItemKey(t,!0);if(void 0===i)return;const s={action:e.ApiOperation.TextPermMarksItem,params:[i,this.Wt]},n=yield this.t.i(s);let o;return d.u.h(this,n),!this.o&&n.detail&&(o=new w(this.t,n.detail)),o}))}add(t,i,s,n){return a(this,void 0,void 0,(function*(){const o={action:e.ApiOperation.TextPermMarksAdd,params:[t,i,null==s?void 0:s.toJson(),n]},r=yield this.t.i(o,!0);let h;return d.u.h(this,r),!this.o&&r.detail&&(h=new w(this.t,r.detail)),h}))}toJson(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextRangeGetCollection,params:["permMark",this.Wt]},i=yield this.t.i(t);let s=[];if(d.u.h(this,i),!this.o){const t=i.detail;for(let e=0;e<t.length;e+=1)s.push(t[e].name)}return s}))}}class w extends c{constructor(t,i){super(t,i,r.ElementType.PERMMARK),Object.defineProperties(this,{name:{get(){return a(this,void 0,void 0,(function*(){const t=yield this._getPermMark();if(!this.o){if(t.detail)return t.detail;console.error("Can not find the element!")}}))}},range:{get(){return a(this,void 0,void 0,(function*(){let t;const e=yield this._getPermMark();if(!this.o){let i,s;if(e.detail)return t=new j(this.t),i=new M(this.t,this,0,r.PositionType.PermMark),s=new M(this.t,this,1,r.PositionType.PermMark),t.buildRange(i,s),t;console.error("Can not find the element!")}}))}},permissionType:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextPermMarkPermissionType,params:[this.id]},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))}}})}_getPermMark(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextPermMarksItem,params:[this.id]},i=yield this.t.i(t);return d.u.h(this,i),i}))}getEditors(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextPermMarkGetAuthUsers,params:[this.id]},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||i.detail&&(s=i.detail),s}))}addEditors(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.TextPermMarkAddUser,params:[this.id,t]},s=yield this.t.i(i,!0);d.u.h(this,s);return!this.o&&s.detail}))}deleteEditors(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.TextPermMarkDeleteUser,params:[this.id,t]},s=yield this.t.i(i,!0);d.u.h(this,s);return!this.o&&s.detail}))}setEditors(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.TextPermMarkSetUser,params:[this.id,t]},s=yield this.t.i(i,!0);d.u.h(this,s);return!this.o&&s.detail}))}remove(){return a(this,void 0,void 0,(function*(){return this.t.Ut("PermMark","remove","delete",!1),!1}))}delete(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextPermMarkDelete,params:[this.id]},i=yield this.t.i(t,!0);d.u.h(this,i);return!this.o&&i.detail}))}setText(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.TextMarkSetText,params:[this.id,t,r.MarkType.PERMMARK]},s=yield this.t.i(i,!0);d.u.h(this,s);let n=!1;return this.o||(n=!0),n}))}getText(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextMarkGetText,params:[this.id,r.MarkType.PERMMARK]},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))}focus(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextMarkFocus,params:[this.id,r.MarkType.PERMMARK]},i=yield this.t.i(t);d.u.h(this,i);let s=!1;return this.o||(s=i.detail),s}))}}class y{constructor(t,i){if(!t)throw"invalid argument";this.t=t,this.$t=i,this.Wt=this.$t&&!this.$t.isAllDocument()?this.$t.toJson():null,Object.defineProperties(this,{count:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextTablesCount,params:[this.Wt]},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))}}})}item(t){return a(this,void 0,void 0,(function*(){const i=u.handleItemKey(t,!0);if(void 0===i)return;const s={action:e.ApiOperation.TextTablesItem,params:[i,this.Wt]},n=yield this.t.i(s);let o;if(d.u.h(this,n),!this.o&&n.detail&&n.detail.id){const t=n.detail;o=new x(this.t,t.id)}return o}))}add(t,i,s){return a(this,void 0,void 0,(function*(){const n=s||{};n.range=this.Wt;const o={action:e.ApiOperation.TextTablesAdd,params:[t,i,n]},r=yield this.t.i(o,!0);let h;return d.u.h(this,r),this.o||(h=new x(this.t,r.detail.id)),h}))}}class x extends c{constructor(t,i){super(t,i,r.ElementType.TABLE),Object.defineProperties(this,{Columns:{get(){return this._columns||(this._columns=new T(t,this.id)),this._columns}},Rows:{get(){return this._rows||(this._rows=new b(t,this.id)),this._rows}},title:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextTableTitle,params:[this.id]},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))},set(t){const i={action:e.ApiOperation.TextTableSetTitle,params:[this.id,t]};this.t.i(i).then((t=>{d.u.h(this,t)}))}},range:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextElementGetRange,params:["table",this.id]},i=yield this.t.i(t);if(d.u.h(this,i),!this.o){const{sRowId:t,eRowId:e,colCount:s}=i.detail,n=new C(this.t,t),o=new C(this.t,e),h=new M(this.t,n,0,r.PositionType.Row),a=new M(this.t,o,s,r.PositionType.Row);return new j(this.t,h,a)}return null}))}}})}setTitle(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.TextTableSetTitle,params:[this.id,t]},s=yield this.t.i(i);return d.u.h(this,s),!this.o&&!0===s.detail}))}delete(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextTableDelete,params:[this.id]},i=yield this.t.i(t,!0);d.u.h(this,i);let s=!1;return this.o||(s=i.detail),s}))}}class b{constructor(t,i){if(!t)throw"invalid argument";this.t=t,this.parentId=i,Object.defineProperties(this,{count:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextRowsCount,params:[this.parentId]},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))}}})}item(t){return a(this,void 0,void 0,(function*(){const i=u.handleItemKey(t,!1);if(void 0===i)return;const s={action:e.ApiOperation.TextRowsItem,params:[this.parentId,i]},n=yield this.t.i(s);let o;return d.u.h(this,n),this.o||n.detail&&(o=new C(this.t,n.detail)),o}))}add(t,i,s){return a(this,void 0,void 0,(function*(){const n={action:e.ApiOperation.TextRowsAdd,params:[this.parentId,t,i,s]},o=yield this.t.i(n,!0);d.u.h(this,o);let r=!1;return this.o||(r=o.detail),r}))}deleteRows(t,i,s){return a(this,void 0,void 0,(function*(){let n=i||1;const o={action:e.ApiOperation.TextRowsDeleteRows,params:[this.parentId,t,n,s]},r=yield this.t.i(o,!0);d.u.h(this,r);let h=!1;return this.o||(h=r.detail),h}))}}class C extends c{constructor(t,i){super(t,i,r.ElementType.ROW),Object.defineProperties(this,{Cells:{get(){return this._cells||(this._cells=new S(t,this.id)),this._cells}},index:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextRowIndex,params:[this.id]},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))}},range:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextElementGetRange,params:["row",this.id]},i=yield this.t.i(t);if(d.u.h(this,i),!this.o){const{rowId:t,colCount:e}=i.detail,s=new C(this.t,t),n=new M(this.t,s,0,r.PositionType.Row),o=new M(this.t,s,e,r.PositionType.Row);return new j(this.t,n,o)}return null}))}}})}delete(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextRowDelete,params:[this.id]},i=yield this.t.i(t,!0);d.u.h(this,i);let s=!1;return this.o||(s=i.detail),s}))}}class T{constructor(t,i){if(!t)throw"invalid argument";this.t=t,this.parentId=i,Object.defineProperties(this,{count:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextColumnsCount,params:[this.parentId]},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))}}})}item(t){return a(this,void 0,void 0,(function*(){const i=u.handleItemKey(t,!1);if(void 0===i)return;const s={action:e.ApiOperation.TextColumnsItem,params:[this.parentId,i]},n=yield this.t.i(s);let o;if(d.u.h(this,n),!this.o&&n.detail&&n.detail.tableId){const t=n.detail;o=new I(this.t,t.tableId,t.colIndex)}return o}))}add(t,i,s){return a(this,void 0,void 0,(function*(){const n={action:e.ApiOperation.TextColumnsAdd,params:[this.parentId,t,i,s]},o=yield this.t.i(n,!0);d.u.h(this,o);let r=!1;return this.o||(r=o.detail),r}))}deleteColumns(t,i,s){return a(this,void 0,void 0,(function*(){let n=i||1;const o={action:e.ApiOperation.TextColumnsDeleteColumns,params:[this.parentId,t,n,s]},r=yield this.t.i(o,!0);d.u.h(this,r);let h=!1;return this.o||(h=r.detail),h}))}}class I{constructor(t,i,s){this.t=t,this.colIndex=s,this.parentId=i,Object.defineProperties(this,{index:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextColumnIndex,params:[this.parentId,this.colIndex]},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))}}})}delete(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextColumnDelete,params:[this.parentId,this.colIndex]},i=yield this.t.i(t,!0);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))}}class S{constructor(t,i){if(!t)throw"invalid argument";this.parentRowId=i,this.t=t,Object.defineProperties(this,{count:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextCellsCount,params:[this.parentRowId]},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))}}})}item(t){return a(this,void 0,void 0,(function*(){const i=u.handleItemKey(t,!1);if(void 0===i)return;const s={action:e.ApiOperation.TextCellsItem,params:[this.parentRowId,i]},n=yield this.t.i(s);let o;if(d.u.h(this,n),!this.o&&n.detail){const t=n.detail;o=new k(this.t,t.id,t.colIndex)}return o}))}}class k extends l{constructor(t,i,s){super(t,i,r.ElementType.CELL),this.isMergedCell=s,Object.defineProperties(this,{range:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextElementGetRange,params:["cell",this.id]},i=yield this.t.i(t);if(d.u.h(this,i),!this.o){const{rowId:t,colIdx:e}=i.detail,s=new C(this.t,t),n=new M(this.t,s,e,r.PositionType.Row),o=new M(this.t,s,e+1,r.PositionType.Row);return new j(this.t,n,o)}return null}))}}})}getRowSpan(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextCellGetRowSpan,params:[this.id]},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))}getColSpan(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextCellGetColSpan,params:[this.id]},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))}getIndex(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextCellGetIndex,params:[this.id]},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))}getHtml(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextCellGetHtml,params:[this.id]},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))}setHtml(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.TextCellSetHtml,params:[this.id,t]},s=yield this.t.i(i,!0);let n;return d.u.h(this,s),this.o||(n=s.detail),n}))}getText(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextCellGetText,params:[this.id]},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))}setText(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.TextCellSetText,params:[this.id,t]},s=yield this.t.i(i,!0);let n;return d.u.h(this,s),this.o||(n=s.detail),n}))}}class R extends c{constructor(t,e){super(t,e,r.ElementType.UNSUPPORTED)}}class N{constructor(t){if(!t)throw"invalid argument";this.t=t,Object.defineProperties(this,{count:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextParagraphsCount,params:{}},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))}}})}item(t){return a(this,void 0,void 0,(function*(){const i=u.handleItemKey(t,!0);if(void 0===i)return;const s={action:e.ApiOperation.TextParagraphsItem,params:[i]},n=yield this.t.i(s);let o;return d.u.h(this,n),!this.o&&n.detail&&(o=new P(this.t,n.detail)),o}))}add(t,i){return a(this,void 0,void 0,(function*(){if("string"!=typeof t)throw new Error("text type error.");const s={action:e.ApiOperation.TextParagraphsAdd,params:[t,i]},n=yield this.t.i(s,!0);let o;if(d.u.h(this,n),!this.o){const t=n.detail;o=new P(this.t,t)}return o}))}}e.Paragraphs=N;class P extends l{constructor(t,i){super(t,i,r.ElementType.PARAGRAPH),Object.defineProperties(this,{range:{get(){return a(this,void 0,void 0,(function*(){const t=yield this._getLength();if(-1===t)throw new Error("Failed to get paragraph length.");const e=new j(this.t);let i,s;return i=new M(this.t,this,0,r.PositionType.Paragraph),s=new M(this.t,this,t,r.PositionType.Paragraph),e.buildRange(i,s),e}))}},style:{get(){return this._style||(this._style=new U(this.t,this)),this._style}},outlineLevel:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextParagraphOutlineLevel,params:[this.id]},i=yield this.t.i(t);let s;if(d.u.h(this,i),!this.o){const t=i.detail;return s="string"==typeof t&&"Normal"===t?r.WdOutlineLevel.wdOutlineLevelBodyText:t,s}}))}},index:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextParagraphGetIndex,params:[this.id]},i=yield this.t.i(t);if(d.u.h(this,i),!this.o)return i.detail}))}}})}_getLength(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextParagraphGetLength,params:[this.id]},i=yield this.t.i(t);d.u.h(this,i);let s=-1;return this.o||i.detail>=0&&(s=i.detail),s}))}getOutlineRange(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextOutlineLevelGetRange,params:[this.id]},i=yield this.t.i(t);if(d.u.h(this,i),!i.detail)return;const s=i.detail.start.type,n=i.detail.end.type,o=new P(this.t,i.detail.start.id);let h;n===r.PositionType.Paragraph?h=new P(this.t,i.detail.end.id):n===r.PositionType.Row&&(h=new C(this.t,i.detail.end.id));const a=i.detail.start.index||0,c=i.detail.end.index||0,u=new M(this.t,o,a,s),l=new M(this.t,h,c,n);return new j(this.t,u,l)}))}getRange(t,e){return a(this,void 0,void 0,(function*(){if(null!=t&&"number"!=typeof t||null!=e&&"number"!=typeof e)throw new Error("invalid argument");let i=null==t?0:t;if(0===i&&null==e){return yield this.range}const s=yield this._getLength();if(-1===s)throw new Error("Failed to get paragraph length.");if(i<0||i>s)throw new Error("invalid startOffset");if(null!=e&&e<0)throw new Error("invalid length");i=Math.trunc(i);let n=Math.trunc(e);null==e&&(n=s),n=i+n>s?s-i:n;const o=new j(this.t);let h,a;return this.o||(h=new M(this.t,this,i,r.PositionType.Paragraph),a=new M(this.t,this,i+n,r.PositionType.Paragraph),o.buildRange(h,a)),o}))}appendText(t){return a(this,void 0,void 0,(function*(){if(!t)return void(this.o="invalid argument");const i={action:e.ApiOperation.TextParagraphAppendText,params:[this.id,t]},s=yield this.t.i(i,!0);d.u.h(this,s);let n=!1;return this.o||(n=!0),n}))}setText(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.TextParagraphSetText,params:[this.id,t]},s=yield this.t.i(i,!0);d.u.h(this,s);let n=!1;return this.o||(n=!0),n}))}clear(){return a(this,void 0,void 0,(function*(){return yield this.setText("")}))}getTextContent(t,i,s){return a(this,void 0,void 0,(function*(){const n={action:e.ApiOperation.TextParagraphGetText,params:[this.toJson(),t,i,s]},o=yield this.t.i(n);let r;return d.u.h(this,o),this.o||(r=o.detail),r}))}getTextAlignment(){return a(this,void 0,void 0,(function*(){}))}setTextAlignment(t){}}class O{constructor(t){if(!t)throw"invalid argument";this.t=t,Object.defineProperties(this,{count:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextOutlineEntriesCount,params:{}},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))}}})}item(t){return a(this,void 0,void 0,(function*(){const i=u.handleItemKey(t,!0);if(void 0===i)return;const s={action:e.ApiOperation.TextOutlineEntriesItem,params:[i]},n=yield this.t.i(s);let o;return d.u.h(this,n),!this.o&&n.detail&&(o=new F(this.t,n.detail)),o}))}}e.OutlineEntries=O;class F{constructor(t,i){this.t=t,this.id=i,Object.defineProperties(this,{outlineRange:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextOutlineEntryRange,params:[this.id,!0]},i=yield this.t.i(t);if(d.u.h(this,i),i.detail)return this.createRange(i.detail)}))}},contentRange:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextOutlineEntryRange,params:[this.id]},i=yield this.t.i(t);if(d.u.h(this,i),i.detail)return this.createRange(i.detail)}))}},level:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextOutlineEntryLevel,params:[this.id]},i=yield this.t.i(t);let s;if(d.u.h(this,i),!this.o){const t=i.detail;return s="string"==typeof t&&"Normal"===t?r.WdOutlineLevel.wdOutlineLevelBodyText:t,s}}))}},paragraph:{get(){return new P(this.t,this.id)}}})}createRange(t){const{index:e,id:i}=t.start,{index:s,id:n,type:o}=t.end,h=new P(this.t,i),a=new M(this.t,h,e,r.PositionType.Paragraph);let c,d;return o===r.PositionType.Row?(c=new C(this.t,n),d=new M(this.t,c,s,r.PositionType.Row)):(c=new P(this.t,n),d=new M(this.t,c,s,r.PositionType.Paragraph)),new j(this.t,a,d)}focus(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextOutlineEntryFocus,params:[this.id]},i=yield this.t.i(t);return d.u.h(this,i),!this.o&&!!i.detail}))}outlineFocus(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextOutlineEntryFocus,params:[this.id,!0]},i=yield this.t.i(t);return d.u.h(this,i),!this.o&&!!i.detail}))}getText(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextOutlineEntryGetText,params:[this.id]},i=yield this.t.i(t);if(d.u.h(this,i),!this.o)return i.detail}))}}e.OutlineEntry=F;class E{constructor(t){if(!t)throw"invalid argument";this.t=t,Object.defineProperties(this,{count:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextRevisionsCount,params:{}},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))}},RevisionsMode:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextGetRevisionsMode,params:{}},i=yield this.t.i(t);return d.u.h(this,i),this.o?"":i.detail}))},set(t){const i={action:e.ApiOperation.TextSetRevisionsMode,params:{status:t}};this.t.i(i).then((t=>{d.u.h(this,t)}))}}})}item(t){return a(this,void 0,void 0,(function*(){const i=u.handleItemKey(t,!1);if(void 0===i)return;const s={action:e.ApiOperation.TextRevisionsItem,params:[i]},n=yield this.t.i(s);let o;if(d.u.h(this,n),!this.o&&n.detail){const t=n.detail;o=new A(this.t,t.id,t.author,t.creator,t.date,t.type,t.isStyle)}return o}))}toJson(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextRevisionsGetAll,params:{}},i=yield this.t.i(t);d.u.h(this,i);let s=[];if(!this.o)for(let t of i.detail){let e={author:t.author,date:t.date,type:t.type,isStyle:t.isStyle};s.push(e)}return s}))}rejectAll(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextRevisionsRejectAll,params:[!1]};yield this.t.i(t)}))}acceptAll(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextRevisionsAcceptAll,params:[!1]};yield this.t.i(t)}))}}class A{constructor(t,i,s,n,o,h,c){this.t=t,this.id=i,this.author=s,this.creator=n,this.date=o,this.type=h,this.isStyle=c,Object.defineProperties(this,{range:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextRevisionRange,params:[this.id]},i=yield this.t.i(t);let s;if(d.u.h(this,i),!this.o){const{start:t,end:e,type:n}=i.detail;let o,h,a;"paragraph"===n?(o=new P(this.t,t.id),h=new P(this.t,e.id),a=r.PositionType.Paragraph):"table"===n&&(o=new C(this.t,t.id),h=new C(this.t,e.id),a=r.PositionType.Row);const c=new M(this.t,o,t.index,a),d=new M(this.t,h,e.index,a);s=new j(this.t,c,d)}return s}))}}})}accept(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextRevisionAccept,params:[this.id]},i=yield this.t.i(t,!0);d.u.h(this,i);let s=!1;return this.o||(s=!0),s}))}reject(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextRevisionReject,params:[this.id]},i=yield this.t.i(t,!0);d.u.h(this,i);let s=!1;return this.o||(s=!0),s}))}}let D;!function(t){t.Bold="bold",t.Italic="italic",t.Underline="underline",t.Color="color",t.ColorIndex="ForeColor",t.Size="fontsize"}(D||(D={}));class j{constructor(t,e,i,s=!1){this.t=t,this.isCollapsed=!s,e&&this.buildRange(e,i),Object.defineProperties(this,{Find:{get(){return this._find||(this._find=new W(t,this)),this._find}},Font:{get(){return this._font||(this._font=new f(t,this)),this._font}},Bookmarks:{get(){return this._bookmarks||(this._bookmarks=new p(t,this)),this._bookmarks}},PermMarks:{get(){return this._permMarks||(this._permMarks=new g(t,this)),this._permMarks}},Comments:{get(){return this._comments||(this._comments=new m(t,void 0,this)),this._comments}},Bold:{get(){return a(this,void 0,void 0,(function*(){return this.Font.Bold}))},set(t){this.Font.Bold=t}},Underline:{get(){return a(this,void 0,void 0,(function*(){return this.Font.Underline}))},set(t){this.Font.Underline=t}},Italic:{get(){return a(this,void 0,void 0,(function*(){return this.Font.Italic}))},set(t){this.Font.Italic=t}},Tables:{get(){return this._tables||(this._tables=new y(t,this)),this._tables}}}),this.isAllDocumentStatus=s}buildRange(t,e){t?(this.start=t,this.end=e,this.start&&this.end&&0!==this.start.compare(this.end)&&(this.isCollapsed=!1)):this.o="invalid argument"}toJson(){const t={};return this.start&&(t.start=this.start.toJson()),this.end&&(t.end=this.end.toJson()),t.isCollapsed=this.isCollapsed,this.isAllDocumentStatus&&(t.isAllDocument=this.isAllDocumentStatus),t}insertPermMark(t,e){return a(this,void 0,void 0,(function*(){return this.t.ActiveDocument.PermMarks.add(t,e,this)}))}compare(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.TextRangeCompare,params:[this.toJson(),t.toJson()]},s=yield this.t.i(i);if(d.u.h(this,s),!this.o){return"partBefore"===s.detail?r.LocationRelation.containsStart:"partBehind"===s.detail?r.LocationRelation.containsEnd:s.detail}}))}appendText(t){return a(this,void 0,void 0,(function*(){if(this.prompt(),!t)return void(this.o="invalid argument");const i=this.end.getOffset(),s={action:e.ApiOperation.TextRangeInsertText,params:[this.end.toJson(),t,this.isAllDocumentStatus]},n=yield this.t.i(s,!0);let o=!1;return d.u.h(this,n),this.o||(o=!0,null!==i&&this.end.setOffset(i+t.length)),o}))}insertText(t,i){return a(this,void 0,void 0,(function*(){this.prompt();const s=this.start.getOffset(),n=this.end.getOffset(),o=n-s,r=t<0?0:t>o?o:t,h=new M(this.t,this.start.getElement(),s+r),a={action:e.ApiOperation.TextRangeInsertText,params:[h.toJson(),i]},c=yield this.t.i(a);let u=!1;return d.u.h(this,c),this.o||(u=c.detail,null!==n&&this.end.setOffset(n+i.length)),u}))}setText(t){return a(this,void 0,void 0,(function*(){this.prompt();let i=null,s=null;this.isAllDocument()||(i=this.start.getOffset(),s=this.end.getOffset());const n={action:e.ApiOperation.TextRangeSetText,params:[this.toJson(),t,this.isAllDocument()]},o=yield this.t.i(n,!0);let r=!1;return d.u.h(this,o),this.o||(r=!0,null!==s&&this.end.setOffset(i+t.length)),r}))}clear(){return a(this,void 0,void 0,(function*(){let t;return this.prompt(),t=yield this.setText(""),t}))}getText(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextRangeGetText,params:[this.toJson()]},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))}prompt(){if(!this.isAllDocument()&&this.start.getPositionType()!==r.PositionType.Paragraph&&this.start.getPositionType()!==r.PositionType.HeaderFooter)throw new Error("Currently only paragraph range is supported!")}isAllDocument(){return this.isAllDocumentStatus}getHtml(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextRangeGetHtml,params:[this.toJson()]},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))}setHtml(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.TextRangeSetHtml,params:[this.toJson(),t]},s=yield this.t.i(i,!0);let n;return d.u.h(this,s),this.o||(n=s.detail),n}))}scrollIntoView(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextRangeScrollIntoView,params:[this.toJson()]},i=yield this.t.i(t,!0);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))}}class M{constructor(t,e,i,s){if(this.t=t,!e)throw"invalid argument";this.element=e,this.offset=i&&i>0||-1===i?i:0,this.zt=s||r.PositionType.Paragraph}compare(t){return t&&t instanceof M&&this.element===t.element&&this.offset===t.offset?0:-1}getElement(){return this.element}getOffset(){return this.offset}getPositionType(){return this.zt}setOffset(t){this.offset=t}getSurroudingText(){return a(this,void 0,void 0,(function*(){}))}toJson(){const t={};return this.element&&(t.element=this.element.toJson&&this.element.toJson(),t.offset=this.offset,t.type=this.zt),t}}class H extends c{constructor(t,e){super(t,e,r.ElementType.INLINESHAPE)}delete(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextPictureDelete,params:[this.id]},i=yield this.t.i(t,!0);d.u.h(this,i);let s=!1;return this.o||(s=i.detail),s}))}focus(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextPictureFocus,params:[this.id]},i=yield this.t.i(t);d.u.h(this,i);let s=!1;return this.o||(s=i.detail),s}))}}class B{constructor(t){if(!t)throw"invalid argument";this.t=t,Object.defineProperties(this,{count:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextInlineShapesCount,params:{}},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))}}})}addPicture(t,i,s){return a(this,void 0,void 0,(function*(){if(!(t instanceof File))throw new Error("invalid argument");if(t.size>r.Constant.MaxImportImageSize)throw new Error("Image size limit 10MB");const n={action:e.ApiOperation.TextPicturesAdd,params:{file:t,isInlineShape:!0,range:null==i?void 0:i.toJson(),bReplace:s}},o=yield this.t.i(n,!0);let h;return d.u.h(this,o),!this.o&&o.detail&&(h=new H(this.t,o.detail)),h}))}item(t){return a(this,void 0,void 0,(function*(){const i=u.handleItemKey(t,!1);if(void 0===i)return;const s={action:e.ApiOperation.TextInlineShapesItem,params:[i]},n=yield this.t.i(s);let o;return d.u.h(this,n),this.o||n.detail&&(o=new H(this.t,n.detail)),o}))}}class G{constructor(t){if(!t)throw"invalid argument";this.t=t,Object.defineProperties(this,{count:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextShapesCount,params:{}},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))}}})}addPicture(t,i,s,n,o,h,c){return a(this,void 0,void 0,(function*(){if(!(t instanceof File))throw new Error("invalid argument");if(t.size>r.Constant.MaxImportImageSize)throw new Error("Image size limit 10MB");let i,s;if(c===r.WdWrapType.wdWrapFront)i="wrapNone",s=0;else if(c===r.WdWrapType.wdWrapBehind)i="wrapNone",s=1;else if(c===r.WdWrapType.wdWrapInline)return this.t.ActiveDocument.InlineShapes.addPicture(t,h);const a=u.isGreaterOrEqualZero(n)?n:void 0,l=u.isGreaterOrEqualZero(o)?o:void 0,m={file:t,isInlineShape:!1,width:a,height:l,range:null==h?void 0:h.toJson(),wrapType:i,behindDoc:s,name:t.name},v={action:e.ApiOperation.TextPicturesAdd,params:m},f=yield this.t.i(v);let p;return d.u.h(this,f),!this.o&&f.detail&&(p=new L(this.t,f.detail)),p}))}item(t){return a(this,void 0,void 0,(function*(){const i=u.handleItemKey(t,!0);if(void 0===i)return;const s={action:e.ApiOperation.TextShapesItem,params:[i]},n=yield this.t.i(s);let o;return d.u.h(this,n),this.o||n.detail&&(o=new L(this.t,n.detail)),o}))}}class L extends c{constructor(t,i){super(t,i,r.ElementType.SHAPE),Object.defineProperties(this,{name:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextShapeName,params:[this.id]},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))},set(t){const i={action:e.ApiOperation.TextShapeSetName,params:[this.id,t]};this.t.i(i).then((t=>{d.u.h(this,t)}))}}})}setName(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.TextShapeSetName,params:[this.id,t]},s=yield this.t.i(i);return d.u.h(this,s),!this.o&&!0===s.detail}))}delete(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextPictureDelete,params:[this.id]},i=yield this.t.i(t);d.u.h(this,i);let s=!1;return this.o||(s=i.detail),s}))}focus(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextPictureFocus,params:[this.id]},i=yield this.t.i(t);d.u.h(this,i);let s=!1;return this.o||(s=i.detail),s}))}}class W{constructor(t,e){if(!t)throw"invalid argument";this.t=t,this.range=e}hitHighlight(t,i,s,n,o){return a(this,void 0,void 0,(function*(){const r={findText:t,matchCase:i,matchWholeWord:s,highlightColor:n,noScroll:o};this.range.isAllDocument()||(r.range=this.range.toJson()),r.noScroll=!!o;const h={action:e.ApiOperation.TextFindHitHighlight,params:[r]},a=yield this.t.i(h);d.u.h(this,a);let c=0;return this.o||(c=a.detail),c}))}findData(t,i,s){return a(this,void 0,void 0,(function*(){const n={findText:t,matchCase:i,matchWholeWord:s,highlight:!1};this.range.isAllDocument()||(n.range=this.range.toJson());const o={action:e.ApiOperation.TextFindData,params:[n]},r=yield this.t.i(o);d.u.h(this,r);let h=0;return this.o||(h=r.detail),h}))}execute(t,i,s,n,o,h=!0){return a(this,arguments,void 0,(function*(){const a=arguments.length<=2?[t,void 0,void 0,void 0,void 0,i]:[t,i,s,n,o,h],c={action:e.ApiOperation.TextFindExecute,params:a},u=yield this.t.i(c,o===r.WdReplace.wdReplaceAll||o===r.WdReplace.wdReplaceOne);d.u.h(this,u);let l=!1;if(!this.o){const t=u.detail;l="number"==typeof t?t:!!t}return l}))}clearHighlight(){return a(this,void 0,void 0,(function*(){let t;this.range.isAllDocument()||(t=this.range.toJson());const i={action:e.ApiOperation.TextFindClearHighlight,params:[t]},s=yield this.t.i(i);d.u.h(this,s);let n=!1;return this.o||(n=!0===s.detail),n}))}}const V={title:r.WdBuiltinStyle.wdStyleTitle,subtitle:r.WdBuiltinStyle.wdStyleSubtitle,"heading 1":r.WdBuiltinStyle.wdStyleHeading1,"heading 2":r.WdBuiltinStyle.wdStyleHeading2,"heading 3":r.WdBuiltinStyle.wdStyleHeading3,"heading 4":r.WdBuiltinStyle.wdStyleHeading4,"heading 5":r.WdBuiltinStyle.wdStyleHeading5,"heading 6":r.WdBuiltinStyle.wdStyleHeading6,"heading 7":r.WdBuiltinStyle.wdStyleHeading7,"heading 8":r.WdBuiltinStyle.wdStyleHeading8,"heading 9":r.WdBuiltinStyle.wdStyleHeading9,normal:r.WdBuiltinStyle.wdStyleNormal};class U{constructor(t,i){if(!t)throw"invalid argument";this.t=t,this._paragraph=i,Object.defineProperties(this,{headingLevel:{get(){return a(this,void 0,void 0,(function*(){if(!this._paragraph)return;const t={action:e.ApiOperation.TextGetHeadingLevel,params:[this._paragraph.id]},i=yield this.t.i(t);let s;return d.u.h(this._paragraph,i),this.o?void 0:(s=V[i.detail]||r.WdBuiltinStyle.wdStyleNormal,s)}))}}})}setHeadingLevel(t){return a(this,void 0,void 0,(function*(){const i=Object.entries(V).find((e=>e[1]===t));if(!i)throw"invalid argument";const s=i[0].charAt(0).toUpperCase()+i[0].slice(1).replace(" ",""),n={action:e.ApiOperation.TextSetHeadingLevel,params:[this._paragraph.id,s]},o=yield this.t.i(n,!0);d.u.h(this._paragraph,o)}))}}class ${constructor(t){if(!t)throw"invalid argument";this.t=t,Object.defineProperties(this,{count:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextSectionsCount,params:{}},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))}},first:{get(){return a(this,void 0,void 0,(function*(){return yield this.item(1)}))}},last:{get(){return a(this,void 0,void 0,(function*(){return yield this.item(-1)}))}}})}item(t){return a(this,void 0,void 0,(function*(){const i=u.handleItemKey(t,!1),s=-1===t;if(void 0===i&&!s)return;const n={action:e.ApiOperation.TextSectionsItem,params:[s?t:i]},o=yield this.t.i(n);let r;return d.u.h(this,o),!this.o&&o.detail&&(r=new z(this.t,o.detail)),r}))}}class z extends l{constructor(t,e){super(t,e,r.ElementType.SECTION),Object.defineProperties(this,{Headers:{get(){return this._headers||(this._headers=new J(this.t,this)),this._headers}},Footers:{get(){return this._footers||(this._footers=new K(this.t,this)),this._footers}}})}}class J{constructor(t,e){if(!t||!e)throw"invalid argument";this.t=t,this._section=e}item(t){return a(this,void 0,void 0,(function*(){if(!Object.values(r.WdHeaderFooterIndex).includes(t))return;const i={action:e.ApiOperation.TextHeadersItem,params:[this._section.id,t]},s=yield this.t.i(i);let n;return d.u.h(this,s),!this.o&&s.detail&&(n=new q(this.t,s.detail)),n}))}}class q extends l{constructor(t,i){if(super(t,i,r.ElementType.HEADERFOOTER),!t)throw"invalid argument";this.t=t,this._id=i,Object.defineProperties(this,{range:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextHeadersItem,params:[null,null,this._id]},i=yield this.t.i(t);let s;if(!this.o){let t,e;if(i.detail)return s=new j(this.t),t=new M(this.t,this,0,r.PositionType.HeaderFooter),e=new M(this.t,this,1,r.PositionType.HeaderFooter),s.buildRange(t,e),s;console.error("Can not find the element!")}return s}))}}})}}class K{constructor(t,e){if(!t)throw"invalid argument";this.t=t,this._section=e}item(t){return a(this,void 0,void 0,(function*(){if(!Object.values(r.WdHeaderFooterIndex).includes(t))return;const i={action:e.ApiOperation.TextFootersItem,params:[this._section.id,t]},s=yield this.t.i(i);let n;return d.u.h(this,s),!this.o&&s.detail&&(n=new Y(this.t,s.detail)),n}))}}class Y extends l{constructor(t,i){if(super(t,i,r.ElementType.HEADERFOOTER),!t)throw"invalid argument";this.t=t,this._id=i,Object.defineProperties(this,{range:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextFootersItem,params:[null,null,this._id]},i=yield this.t.i(t);let s;if(!this.o){let t,e;if(i.detail)return s=new j(this.t),t=new M(this.t,this,0,r.PositionType.HeaderFooter),e=new M(this.t,this,1,r.PositionType.HeaderFooter),s.buildRange(t,e),s;console.error("Can not find the element!")}return s}))}}})}}class X extends t.ActiveWindow{constructor(t){super(t),Object.defineProperties(this,{revisionsView:{get(){return a(this,void 0,void 0,(function*(){this.t=t;const i={action:e.ApiOperation.TextGetRevisionsView,params:{}},s=yield this.t.i(i);return d.u.h(this,s),this.o||!0!==s.detail?r.WdRevisionsView.wdRevisionsViewOriginal:r.WdRevisionsView.wdRevisionsViewFinal}))},set(t){if(t!==r.WdRevisionsView.wdRevisionsViewFinal&&t!==r.WdRevisionsView.wdRevisionsViewOriginal)throw new Error("Invalid argument");const i={action:e.ApiOperation.TextSetRevisionsView,params:{status:t}};this.t.i(i,!0).then((t=>{d.u.h(this,t)}))}},showComments:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextGetCommentsStatus,params:{}},i=yield this.t.i(t);return d.u.h(this,i),!this.o&&!0===i.detail}))},set(t){if("boolean"!=typeof t)throw new Error("Invalid argument");const i={action:e.ApiOperation.TextSetCommentsStatus,params:{show:t}};this.t.i(i,!0).then((t=>{d.u.h(this,t)}))}},showRevisionsAndComments:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextGetRevisionAndCommentsStatus,params:{}},i=yield this.t.i(t);return d.u.h(this,i),!this.o&&!0===i.detail}))},set(t){if("boolean"!=typeof t)throw new Error("Invalid argument");const i={action:e.ApiOperation.TextSetRevisionAndCommentsStatus,params:{show:t}};this.t.i(i,!0).then((t=>{d.u.h(this,t)}))}}})}getRange(t,i,s,n){return a(this,void 0,void 0,(function*(){if(!(t&&t.id&&s&&s.id))return;const o={start:t.id,end:s.id},r={startIndex:i,endIndex:n},h={action:e.ApiOperation.TextContainerElementInsectObject,params:[o,r]},a=yield this.t.i(h);if(d.u.h(this,a),!a.detail)return;const c=a.detail.startType,u=a.detail.endType,l=new M(this.t,t,i,c),m=new M(this.t,s,n,u);return new j(this.t,l,m)}))}setShowComments(t){return a(this,void 0,void 0,(function*(){if("boolean"!=typeof t)throw new Error("Invalid argument");const i={action:e.ApiOperation.TextSetCommentsStatus,params:{show:t}},s=yield this.t.i(i);return d.u.h(this,s),!this.o&&!0===s.detail}))}setShowRevisionsAndComments(t){return a(this,void 0,void 0,(function*(){if("boolean"!=typeof t)throw new Error("Invalid argument");const i={action:e.ApiOperation.TextSetRevisionAndCommentsStatus,params:{show:t}},s=yield this.t.i(i);return d.u.h(this,s),!this.o&&!0===s.detail}))}}class Z extends t.IDocsApp{constructor(s){super(s,t.DocumentType.TEXT),this.OAExtention={moveFootArea(t,i,s){return a(this,void 0,void 0,(function*(){if(!i||"string"!=typeof i)throw"invalid argument";const n=new _(t,i),o={action:e.ApiOperation.TextOaextMoveFootArea,params:[n.toJson(),s]};yield t.i(o)}))},getShapePosition(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.TextOaextGetShapePosition,params:[t.toJson().id]},s=yield this.app.i(i);if(d.u.h(this,s),!this.o)return s.detail}))}},this._supported_events=new Set([...this._supported_events,...i]),this.OAExtention.app=this,Object.defineProperties(this,{ActiveDocument:{get(){return this._ActiveDocument||(this._ActiveDocument=new Q(this)),this._ActiveDocument}}})}Jt(t,e,i){(e?console.warn:console.error)(`The Application.${t} api ${e?"will be":"was"} deprecated, please use Application.ActiveDocument.${i||t} api`)}Ut(t,e,i,s){(s?console.warn:console.error)(`The ${t}.${e} api ${s?"will be":"was"} deprecated, please use ${t}.${i} api`)}switchDataProtectionMode(){return this.Jt("switchDataProtectionMode",!0),this.ActiveDocument.switchDataProtectionMode()}isDataProtectionOn(){return this.Jt("isDataProtectionOn",!0),this.ActiveDocument.isDataProtectionOn()}disableTrackChange(){return this.Jt("disableTrackChange",!0),this.ActiveDocument.disableTrackChange()}enableTrackChange(){return this.Jt("enableTrackChange",!0),this.ActiveDocument.enableTrackChange()}CleanDocument(){return this.Jt("CleanDocument",!0),this.ActiveDocument.CleanDocument()}CleanComments(){return this.Jt("CleanComments",!0),this.ActiveDocument.CleanComments()}getBookmark(t){return this.Jt("getBookmark",!0,"Bookmarks.item"),this.ActiveDocument.getBookmark(t)}selectBookmarkTextInScope(t){return this.Jt("selectBookmarkTextInScope",!0),this.ActiveDocument.selectBookmarkTextInScope(t)}copyToInternal(t){return this.Jt("copyToInternal",!0),this.ActiveDocument.copyToInternal(t)}pasteFromInternal(t,e=!0){return this.Jt("pasteFromInternal",!0),this.ActiveDocument.pasteFromInternal(t,e)}save(){return this.Jt("save",!0),this.ActiveDocument.save()}getParagraphs(t){return this.Jt("getParagraphs",!0),this.ActiveDocument.getParagraphs(t)}saveAs(t,e,i){this.Jt("saveAs")}print(){this.Jt("print")}insertParagraph(t,e){this.Jt("insertParagraph")}appendParagraph(t){this.Jt("appendParagraph")}getSelection(){this.Jt("getSelection")}rejectAllRevisions(){return a(this,void 0,void 0,(function*(){return this.Jt("rejectAllRevisions",!0),this.ActiveDocument.rejectAllRevisions()}))}acceptAllRevisions(){return a(this,void 0,void 0,(function*(){return this.Jt("acceptAllRevisions",!0),this.ActiveDocument.acceptAllRevisions()}))}setUIState(t){return a(this,void 0,void 0,(function*(){if(!t||"focus"in t&&"boolean"!=typeof t.focus||"scroll"in t&&"boolean"!=typeof t.scroll)throw new Error("Invalid cursorContext params!");const i={action:e.ApiOperation.TextAppSetUIState,params:t},s=yield this.i(i);d.u.h(this,s);let n=!1;return this.o||(n=s.detail),n}))}}e.APP=Z;class Q extends t.IDocsDocument{constructor(t){super(t),Object.defineProperties(this,{ActiveWindow:{get(){return this._ActiveWindow||(this._ActiveWindow=new X(this.t)),this._ActiveWindow}},Bookmarks:{get(){return this._bookmarks||(this._bookmarks=new p(this.t)),this._bookmarks}},PermMarks:{get(){return this._permMarks||(this._permMarks=new g(this.t)),this._permMarks}},Comments:{get(){return this._comments||(this._comments=new m(t)),this._comments}},Paragraphs:{get(){return this._paragraphs||(this._paragraphs=new N(this.t)),this._paragraphs}},Tables:{get(){return this._tables||(this._tables=new y(this.t)),this._tables}},Revisions:{get(){return this._revisions||(this._revisions=new E(this.t)),this._revisions}},Shapes:{get(){return this._shapes||(this._shapes=new G(this.t)),this._shapes}},InlineShapes:{get(){return this._inlineShapes||(this._inlineShapes=new B(this.t)),this._inlineShapes}},Sections:{get(){return this._sections||(this._sections=new $(this.t)),this._sections}},Content:{get(){return this._content||(this._content=new j(this.t,null,null,!0)),this._content}},Hyperlinks:{get(){return this._hyperlinks||(this._hyperlinks=new et(this.t)),this._hyperlinks}},ContentFrames:{get(){return this._contentFrames||(this._contentFrames=new it(this.t)),this._contentFrames}},OutlineEntries:{get(){return this._outlines||(this._outlines=new O(this.t)),this._outlines}},WebClipboard:{get(){return this._webClipboard||(this._webClipboard=new tt(this.t)),this._webClipboard}},ProtectionType:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextProtectionType,params:{}},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail),s?s&r.ProtectionType.Forms?r.ProtectionType.Readonly:s&r.ProtectionType.FormEntry?r.ProtectionType.FormEntry:s&r.ProtectionType.EditArea?r.ProtectionType.EditArea:s&r.ProtectionType.Comments?r.ProtectionType.Comments:s&r.ProtectionType.Readonly?r.ProtectionType.Forms:s&r.ProtectionType.Revision?r.ProtectionType.Revision:s:r.ProtectionType.NoProtection}))}},PermissionType:{get(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextDefaultEditAuthType,params:{}},i=yield this.t.i(t);d.u.h(this,i);let s=r.DocPermission.None;if(!this.o){const{type:t,defaultEditable:e}=i.detail;t&r.ProtectionType.EditArea&&(s=e?r.DocPermission.Editable:r.DocPermission.ReadOnly)}return s}))}}})}getSelectionPosition(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextSelectionGetPosition,params:{}},i=yield this.t.i(t);d.u.h(this,i);let s=null;return this.o||(s=i.detail),s}))}unprotect(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextSwitchDataProtectionMode,params:{check:!1}},i=yield this.t.i(t,!0);d.u.h(this,i);let s=!1;return this.o||(s=i.detail),s}))}protect(t,i){return a(this,void 0,void 0,(function*(){if(!t||"number"!=typeof t||t<=0)return console.error(`Please provide correct parameters, invalid type: ${t}`),!1;let s=0;if(h.includes(t))s=t&r.ProtectionType.Forms?r.ProtectionType.Readonly:t&r.ProtectionType.Readonly?r.ProtectionType.Forms:t;else{const e=[];let i;for(const s of h)if(t&s){if(2===e.length){i=!0;break}if(s===r.ProtectionType.Forms?e.push(r.ProtectionType.Readonly):s===r.ProtectionType.Readonly?e.push(r.ProtectionType.Forms):e.push(s),2===e.length&&!(t&r.ProtectionType.Revision)){i=!0;break}}if(i||!e.length)return console.error(`Please provide correct parameters, invalid type: ${t}`),!1;s=e[0]|e[1]}const n={check:!0,ztype:s};s&r.ProtectionType.EditArea&&(n.defaultEditAuthType=i===r.DocPermission.Editable?r.DocPermission.Editable:r.DocPermission.ReadOnly);const o={action:e.ApiOperation.TextSwitchDataProtectionMode,params:n},a=yield this.t.i(o);d.u.h(this,a);let c=!1;return this.o||(c=a.detail),c}))}switchDataProtectionMode(){return a(this,void 0,void 0,(function*(){const t=yield this.isDataProtectionOn(),i={action:e.ApiOperation.TextSwitchDataProtectionMode,params:{check:!t,ztype:r.ProtectionType.EditArea}},s=yield this.t.i(i);d.u.h(this,s);let n=!1;return this.o||(n=s.detail),n}))}isDataProtectionOn(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.IDocsIsDataProtectionOn,params:{}},i=yield this.t.i(t);d.u.h(this,i);let s=!1;return this.o||(s=i.detail),s}))}disableTrackChange(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextSetTrackChange,params:[!1]};yield this.t.i(t)}))}enableTrackChange(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextSetTrackChange,params:[!0]};yield this.t.i(t)}))}getParagraphs(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.TextParagraphsAll,params:[t]},s=yield this.t.i(i),n=[];if(d.u.h(this,s),!this.o){const t=s.detail;for(let e=0;e<t.length;e+=1)n.push(new P(this.t,t[e]))}return n}))}getPageHeight(){return 0}getPageWidth(){return 0}setPageHeight(t){}setPageWidth(t){}getTextAlignment(){return a(this,void 0,void 0,(function*(){}))}setTextAlignment(t){}selectBookmarkTextInScope(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.TextSelectBookmarkTextInScope,params:[t,"paragraph","self"]};yield this.t.i(i)}))}copyToInternal(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.TextCopyToInternal,params:[t]};yield this.t.i(i)}))}pasteFromInternal(t,i=!0){return a(this,void 0,void 0,(function*(){const s={action:e.ApiOperation.TextPasteFromInternal,params:[t,i]};yield this.t.i(s)}))}CleanDocument(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextCleanDocument,params:[!1]};yield this.t.i(t)}))}CleanComments(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextCleanComments,params:[!0]};yield this.t.i(t)}))}getWordCount(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.TextGetWordsCount,params:[t]},s=yield this.t.i(i);return d.u.h(this,s.detail),s.detail}))}getPageCount(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextGetPageCount},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))}getContent(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextBodyGetContent},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))}setContent(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.TextBodySetContent,params:[t]},s=yield this.t.i(i,!0);let n=!1;return d.u.h(this,s),this.o||(n=!0),n}))}getHtml(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextBodyGetHtml},i=yield this.t.i(t,!0);let s="";return d.u.h(this,i),this.o||(s=i.detail),s}))}setHtml(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.TextBodySetHtml,params:[t]},s=yield this.t.i(i);let n=!1;return d.u.h(this,s),this.o||(n=!0),n}))}getSelection(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextGetSelection},i=yield this.t.i(t);let s;if(d.u.h(this,i),!this.o){const t=i.detail;if(t.start){s=new j(this.t);let e=new P(this.t,t.start.id);const i=new M(this.t,e,t.start.offset);let n=null;!t.isCollapsed&&t.end?(e=new P(this.t,t.end.id),n=new M(this.t,e,t.end.offset)):n=new M(this.t,e,t.start.offset),s.buildRange(i,n)}}return s}))}setSelection(t){return a(this,void 0,void 0,(function*(){if(!(t&&t instanceof j))return void(this.o="invalid argument");const i=t.isAllDocument(),s={action:e.ApiOperation.TextSetSelection,params:[t.toJson(),!1,i,!0]},n=yield this.t.i(s);let o=!1;return d.u.h(this,n),this.o||(o=!0),o}))}getBookmark(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.TextBookmarksItem,params:[t]},s=yield this.t.i(i);if(d.u.h(this,s),!this.o&&s.detail)return new _(this.t,s.detail)}))}jumpToMark(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.jumpToMark,params:[t]};yield this.t.i(i)}))}getName(){return a(this,void 0,void 0,(function*(){const t={action:e.ApiOperation.TextGetDocProperty,params:["title"]},i=yield this.t.i(t);let s;return d.u.h(this,i),this.o||(s=i.detail),s}))}getElement(t,e){let i;return e&&e.id&&(i=t===r.ElementType.PARAGRAPH?new P(this.t,e.id):new R(this.t,e.id)),i}contentFormatted(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.TextContentFormatted,params:t?[t]:{}};yield this.t.i(i)}))}rejectAllRevisions(){return a(this,void 0,void 0,(function*(){return this.Revisions.rejectAll()}))}acceptAllRevisions(){return a(this,void 0,void 0,(function*(){return this.Revisions.acceptAll()}))}}e.Document=Q;class tt{constructor(t){this.t=t,Object.defineProperties(this,{Copy:{set(t){this.copyData(t)}},Paste:{get(){return a(this,void 0,void 0,(function*(){return yield this.pasteData()}))},set(t){this.pasteData(t)}}})}copyData(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.TextWebClipboardCopy,params:[t.toJson()]},s=yield this.t.i(i);return d.u.h(this,s),s}))}pasteData(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.TextWebClipboardPaste,params:[t.toJson()]},s=yield this.t.i(i,!0);return d.u.h(this,s),s}))}}class et{constructor(t){if(!t)throw"invalid argument";this.t=t}add(t){return a(this,void 0,void 0,(function*(){const i={action:e.ApiOperation.HyperlinksAdd,params:[t.Address,t.TextToDisplay]},s=yield this.t.i(i,!0);d.u.h(this,s)}))}}class it extends t.ContentFrames{constructor(t){super(t),this.t=t}add(e,i,s){return a(this,void 0,void 0,(function*(){if(!e)throw new Error(`invalid size: ${e}`);if(!e.height||"number"!=typeof e.height)throw new Error(`invalid height: ${e.height}, please input a valid number`);if(e.width&&"number"!=typeof e.width||0===e.width)throw new Error(`invalid width: ${e.width}, please input a valid number`);const n={action:t.ApiOperation.IDocsContentFramesAdd,params:[{size:e,src:i,resizeAble:s}]},o=yield this.t.i(n);return d.u.h(this,o),!this.o&&o.detail?new st(this.t,o.detail):void 0}))}}class st extends t.ContentFrame{constructor(t,e){super(t,e)}}e.ContentFrame=st}(h||(h={}));const d={version:t.Docs_SDK_Version,u:new t.ApiObjHelper,applications:new Map,supported_events:new Set(["IDOCS.Event.FileOpen"]),addListener(t,e,i){document.querySelector(t)?"function"==typeof i?this.supported_events.has(e)?this.u.Y(t,i):console.error(`event type "${e}" is not supported.`):console.error("callback is not a function."):console.error(`No element found for the selector "${t}".`)},removeListener(t,e){document.querySelector(t)?this.supported_events.has(e)?this.u.X(t):console.error(`event type "${e}" is not supported.`):console.error(`No element found for the selector "${t}".`)},mount(t,e,i,s){var n,o,r,h,c,d,u;return a(this,void 0,void 0,(function*(){const a="object"==typeof t;let l,m;if(a){if(!(t.documentServerAddr&&(null===(n=t.repoConfig)||void 0===n?void 0:n.id)&&(null===(o=t.meta)||void 0===o?void 0:o.id)&&(null===(r=t.openConfig)||void 0===r?void 0:r.action)))throw new Error("invalid init config, please check the documentServerAddr, repoConfig.id, meta.id and openConfig.action");m=t;const e=new URL(`docs/app/${m.repoConfig.id}/${m.meta.id}/${m.openConfig.action}/content`,m.documentServerAddr);for(const t in m.openConfig)m.openConfig.hasOwnProperty(t)&&"action"!==t&&e.searchParams.set(t,m.openConfig[t]);l=e.href}else l=t;const v=document.querySelector(e);if(v){let t=v.querySelector(".zOffice-wrapper");if(!t){v.innerHTML="";const e=this.u.F,i=a&&(null===(c=null===(h=m.domConfig)||void 0===h?void 0:h.iframe)||void 0===c?void 0:c.id)||`zOffice-wrapper-${e}`;if(t=document.createElement("iframe"),t.id=i,t.className="zOffice-wrapper",t.width="100%",t.height="100%",t.style.border="none",t.allowFullscreen=!0,t.allow="fullscreen *",t.src="",a){const i=`${t.id}-${Date.now()}`;t.name=i,(null===(u=null===(d=m.domConfig)||void 0===d?void 0:d.iframe)||void 0===u?void 0:u.style)&&Object.assign(t.style,m.domConfig.iframe.style);const s=document.createElement("form");s.id=`zOffice-form-${e}`,s.className="zOffice-form",s.name=s.id,s.style.display="none",s.action=l,s.method="post",s.target=i;const n=document.createElement("input");n.name="params",n.type="hidden";const o=document.createElement("input");o.name="token",o.type="hidden",s.appendChild(n),s.appendChild(o),v.appendChild(s)}v.appendChild(t)}if(a){const t=v.querySelector(".zOffice-form"),e={};for(const t in m)m.hasOwnProperty(t)&&"token"!==t&&"domConfig"!==t&&(e[t]=m[t]);const i=t.querySelector('input[name="params"]'),s=t.querySelector('input[name="token"]');i.value=JSON.stringify(e),s.value=m.token,t.submit()}else t.src=l;yield function(t){return new Promise(((e,i)=>{t.onload=()=>{e("iFrame load success")},t.onerror=()=>{i("iFrame load error")}})).catch((t=>{}))}(t).then((t=>{}));if(!(yield this.u.q(e,t.contentWindow,l,i,s)))return this.applications.delete(e),null;return yield this.qt(e).catch((()=>null))}throw new Error(`No element found for the selector "${e}".`)}))},connect(t,e){return a(this,void 0,void 0,(function*(){let i;const s=document.querySelector(t);if(!s)throw new Error(`Invalid selector!${t}`);{const n=s.querySelector("iframe");if(!n)throw new Error("No iframe!");n.classList.add("zOffice-wrapper"),n.id=`zOffice-wrapper-${this.u.F}`,i=yield this.u.q(t,n.contentWindow,n.src,e)}if(i){return yield this.qt(t).catch((()=>null))}return null}))},connectParent(){return a(this,void 0,void 0,(function*(){const e=t.Parent_Document_Selector;if(yield this.u.q(e,window.parent)){return yield this.qt(e).catch((()=>null))}return null}))},qt(i){return a(this,void 0,void 0,(function*(){const n=yield this.u.U(i);let r;switch(this.u.W(i,n),n){case t.DocumentType.SHEET:r=new o.APP(i);break;case t.DocumentType.TEXT:r=new h.APP(i);break;case t.DocumentType.OFD:case t.DocumentType.PDF:r=new e.APP(i);break;case t.DocumentType.PRES:r=new s.APP(i)}if(r)return this.applications.set(i,r),n===t.DocumentType.SHEET&&(yield r.ActiveWorkbook.getSheets()),r;this.applications.delete(i)}))}};window.addEventListener("message",(e=>{const i=e.data,s=i&&i.type,n=i&&i.data,o=n&&n.docUrl;switch(s){case t.IframeMessageType.unReady:d.u.G(o,!0),d.u.Z(o,!1);break;case t.IframeMessageType.isReady:d.u.G(o,!1),d.u.Z(o,!0);break;case t.IframeMessageType.NoPermissions:d.u.L(o,"No permissions, please configure a valid whitelist!");break;case t.IframeMessageType.OldSDKVersion:d.u.L(o,"The SDK version is too old, please upgrade the version to match zOffice!")}}));class u{static isJSON(t){if("object"!=typeof t)return!1;try{const e=JSON.stringify(t);if("string"!=typeof e)return!1;const i=JSON.parse(e);return!("object"!=typeof i||!i)}catch(t){return!1}}static isGreaterOrEqualZero(t){return!("number"!=typeof t||!/^[+]{0,1}(\d+)$|^[+]{0,1}(\d+\.\d+)$/.test(t.toString()))}static handleItemKey(t,e){return"number"==typeof t&&/^[1-9]+.?[0-9]*/.test(t.toString())?Math.trunc(t):"string"==typeof t&&e?t:void 0}static tt(){return Math.floor(1e9+9e9*Math.random())}}u.checkMimeType=t=>{const e=t.name.substring(t.name.lastIndexOf("."));return!![".jpg",".jpe",".jpeg",".png",".gif",".bmp"].includes(e.toLowerCase())},window.ZOfficeSDK=d||{},window.Word=r||{},window.Excel=n||{}})();
//# sourceMappingURL=sdk.js.map